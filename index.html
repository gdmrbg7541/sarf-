<!DOCTYPE html>
<html lang="tr" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <title>Kelimenin Serüveni - Seviye 2</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Harmattan:wght@400;700&family=Marhey:wght@400;700&display=swap" rel="stylesheet">

   

<style>
        :root {
            --font-family: 'Marhey', sans-serif;
            --font-family-arabic: 'Harmattan', serif;
            --primary-color: #007bff; /* Mavi */
            --success-color: #28a745; 
            --error-color: #dc3545; /* Kırmızı */
            
            --background-color: #f8f9fa; 
            --panel-background: #f8f9fa; 
            
            --text-color: #343a40; 
            --light-text-color: #adb5bd;
            
            --border-color: transparent; 
            
            /* GÜNCELLENDİ: Daha güçlü 3D gölgeler */
            --shadow-light: -8px -8px 16px rgba(255, 255, 255, 1);
            --shadow-dark: 8px 8px 16px rgba(0, 0, 0, 0.12);
            --shadow-inset: inset -6px -6px 12px rgba(255, 255, 255, 1), inset 6px 6px 12px rgba(0, 0, 0, 0.12);

            --container-width: 90%; 
            --base-font-size: 3.5em; 
            
            --circle-size: 42px; 
            --circle-font-size: 1.3em; 
        }

        html, body { 
            height: 100%; 
            margin: 0; 
            padding: 0; 
            overflow: hidden; 
            overscroll-behavior: none;
            -webkit-text-size-adjust: 100%; /* iOS zoom'u engelle */
        }
        
        body {
            font-family: var(--font-family) !important;
            background-color: var(--background-color); 
            color: var(--text-color);
            
            /* EKLENDİ: Mat/Kumlu Doku Efekti */
            background-image: linear-gradient(45deg, rgba(0,0,0,0.02) 25%, transparent 25%, transparent 75%, rgba(0,0,0,0.02) 75%),
                              linear-gradient(45deg, rgba(0,0,0,0.02) 25%, transparent 25%, transparent 75%, rgba(0,0,0,0.02) 75%);
            background-size: 4px 4px;
            background-position: 0 0, 2px 2px;
            
            display: flex; align-items: center; justify-content: center;
            min-height: 100vh;
            padding: 5px; box-sizing: border-box; direction: ltr;
        }
        
        #game-container {
             width: var(--container-width); 
             position: relative;
             margin: auto; 
        }
        main { display: none; }
        main.active { display: block; }

        /* GÜNCELLENDİ: Ana panel (Kutusuz tasarım) */
        #level2-container {
            width: 100%; 
            margin: 0 auto;
            padding: 25px; /* İç boşluk artırıldı */
            background-color: var(--panel-background); /* Arka planla aynı renk */
            border-radius: 20px;
            /* GÜNCELLENDİ: 3D Kabartma efekti */
            box-shadow: var(--shadow-light), var(--shadow-dark);
            direction: rtl;
            text-align: center;
            max-height: 98vh;
            display: flex;
            flex-direction: column;
            justify-content: center; 
            overflow-y: auto; 
        }

        #l2-root-area {
            display: flex; 
            justify-content: center; 
            align-items: center; 
            gap: 10px; 
            padding: 5px 0px; 
            margin-bottom: 10px;
            width: 100%;
            flex-shrink: 0; 
        }
        
        .l2-passive-suffixes {
            font-family: var(--font-family-arabic) !important;
            font-size: 2.6em; 
            color: var(--text-color); /* siyah */
            opacity: 1;
            direction: rtl;
            text-align: center; 
            user-select: none;
            transition: opacity 0.5s ease;
            flex-shrink: 0; 
            flex-grow: 1; 
        }
        .l2-passive-suffixes.faded {
             opacity: 0.1; /* Daha da soluk */
             pointer-events: none;
        }

        #l2-draggable-root-wrapper { 
            align-self: center; 
            display: flex; 
            justify-content: center; 
            margin: 0 10px; 
            position: relative;
        }

        /* GÜNCELLENDİ: Kök Kartı (Cam efekti -> 3D Mat Kabartma) */
        .l2-draggable-root { 
            display: inline-flex; align-items: center; gap: 15px; 
            padding: 12px 24px; 
            font-family: var(--font-family-arabic) !important; 
            font-size: calc(var(--base-font-size) * 1.3); 
            font-weight: bold; line-height: 1; 
            
            background-color: var(--background-color); /* Arka planla aynı */
            backdrop-filter: none; /* Cam efekti kaldırıldı */
            border: none; /* Sınır kaldırıldı */
            
            color: var(--text-color); 
            border-radius: 15px; 
            cursor: grab; 
            transition: box-shadow 0.2s ease, transform 0.2s ease, opacity 0.5s ease; 
            
            /* GÜNCELLENDİ: 3D Kabartma efekti */
            box-shadow: var(--shadow-light), var(--shadow-dark);
            
            user-select: none; 
            position: relative;
            z-index: 2;
            touch-action: none; 
        }
        .l2-draggable-root span { 
            display: inline-block; 
            font-family: var(--font-family-arabic) !important; 
        }
        
        .l2-draggable-root:hover { 
            transform: translateY(-3px); 
            /* Arka plan değişimi kaldırıldı */
            box-shadow: -8px -8px 16px rgba(255, 255, 255, 1), 8px 8px 16px rgba(0, 0, 0, 0.1); 
        }

        .l2-draggable-root.faded {
            opacity: 0.3; 
            pointer-events: none;
            cursor: default; 
            box-shadow: none; /* Solukken gölge olmasın */
        }
        
        /* GÜNCELLENDİ: Sürüklenen hayalet kart (Mat görünüm) */
        .drag-ghost { 
            position: fixed; 
            top: 0; left: 0; 
            display: inline-flex; align-items: center; gap: 15px; 
            padding: 12px 24px; 
            font-family: var(--font-family-arabic) !important; 
            font-size: calc(var(--base-font-size) * 1.3); 
            font-weight: bold; line-height: 1; 
            
            background-color: var(--background-color); /* Mat arka plan */
            backdrop-filter: none;
            border: 2px dashed var(--primary-color); 
            
            color: var(--text-color); 
            border-radius: 15px; 
            box-shadow: 0 8px 20px rgba(0,0,0,0.2); 
            transform: scale(1.05) !important; 
            opacity: 1; 
            pointer-events: none; 
            z-index: 1000; 
            direction: rtl !important; 
            transition: none; 
        }
        .drag-ghost span { display: inline-block; font-family: var(--font-family-arabic) !important; }

        #l2-mistakes { display: none; } 

        /* GÜNCELLENDİ: Türkçe kelime alanı (Kutusuz) */
        #l2-turkish-words-progress {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 0 0 20px 0; 
            padding: 10px;
            border-radius: 10px;
            background-color: transparent; /* Kutu kaldırıldı */
            direction: ltr;
            flex-wrap: wrap; 
            flex-shrink: 0; 
        }
        
        /* GÜNCELLENDİ: Türkçe kelime (3D Kabartma) */
        .l2-turkish-word {
            font-family: var(--font-family) !important; 
            font-size: 1.6em; 
            font-weight: bold;
            color: var(--text-color); 
            padding: 10px 18px;
            border-radius: 8px;
            background-color: var(--background-color); 
            border: none; /* Sınır kaldırıldı */
            transition: all 0.3s ease;
            opacity: 1;
            margin: 3px; 
            box-shadow: var(--shadow-light), var(--shadow-dark);
        }

        
        /* GÜNCELLENDİ: Aktif kelime (Parlak Kırmızı Çerçeve) */
        .l2-turkish-word.active {
            color: var(--text-color);
            border: 4px solid var(--error-color); /* Kalın kırmızı çerçeve */
            transform: scale(1.1); /* Biraz daha büyük */
            box-shadow: 0 0 15px var(--error-color); /* Parlak kırmızı gölge */
            opacity: 1;
        }
        
        /* GÜNCELLENDİ: Aktif kök kartı (Sürüklenebilir Animasyon) */
        .l2-draggable-root.active {
            /* "Beni sürükle" efekti için animasyonu geri getiriyoruz */
            animation: pulse-vurgu-glass 1.5s infinite ease-in-out;
            /* Bastırma efektleri (box-shadow ve transform) kaldırıldı */
        }

        /* GÜNCELLENDİ: Tamamlanan kelime (Başarılı) */
        .l2-turkish-word.done {
            background-color: var(--success-color); 
            color: white; 
            border: none; 
            opacity: 1; 
            filter: none; 
            transform: scale(1);
            box-shadow: none; /* Renkli olunca gölgeye gerek yok */
        }
        
        /* GÜNCELLENDİ: Hatalı kelime (Hatalı) */
        .l2-turkish-word.failed {
            background-color: var(--error-color); 
            color: white; 
            border: none; 
            opacity: 1; 
            filter: none; 
            transform: scale(1);
            box-shadow: none; /* Renkli olunca gölgeye gerek yok */
            animation: none; 
        }
        
        .l2-turkish-word.correct { 
            animation: flash-correct 0.5s; 
        }
        
        .l2-turkish-word.incorrect { 
             animation: flash-incorrect 0.5s;
             animation-name: flash-incorrect; 
             animation-iteration-count: 1;
        }

        .l2-turkish-word.faded,
        .l2-turkish-word.done.faded,
        .l2-turkish-word.failed.faded {
            opacity: 0.3; 
            filter: grayscale(80%); 
            pointer-events: none;
            background-color: var(--background-color); 
            color: var(--light-text-color); 
            border: none; 
            box-shadow: var(--shadow-light), var(--shadow-dark);
        }

        /* GÜNCELLENDİ: Kalıp ızgarası */
        #l2-patterns-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr; 
            grid-template-rows: auto auto auto auto; 
            gap: 15px; /* Boşluk artırıldı */
            padding-top: 20px; /* Boşluk artırıldı */
            border-top: 2px solid rgba(0,0,0,0.05); /* Daha yumuşak çizgi */
            width: 90%; 
            margin-left: auto; 
            margin-right: auto; 
            flex-grow: 0; 
        }

        /* GÜNCELLENDİ: Kalıp Kutusu (3D Kabartma) */
        .l2-pattern-group {
            background-color: var(--background-color);
            border: none; /* Sınır kaldırıldı */
            border-radius: 15px;
            padding: 8px;
            padding-right: calc(var(--circle-size) + 12px); 
            transition: all 0.3s ease;
            position: relative;
            min-height: calc(var(--base-font-size) * 2.0); 
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            /* GÜNCELLENDİ: 3D Kabartma efekti */
            box-shadow: var(--shadow-light), var(--shadow-dark);
        }
        
        /* GÜNCELLENDİ: Üzerine gelme (İçine bastırılmış) */
        .l2-pattern-group.dragover { 
            border: none; 
            background-color: var(--background-color);
            box-shadow: var(--shadow-inset);
        }
        
        .l2-pattern-group.incorrect-flash { 
            animation: shake 0.5s; 
            box-shadow: var(--shadow-inset), 0 0 10px var(--error-color); /* Hata efekti */
            background-color: var(--background-color) !important; 
        }
        
        .l2-pattern-group.faded { 
            opacity: 0.3; 
            pointer-events: none; 
            transition: opacity 0.5s ease; 
        }

        .l2-pattern-group.highlight-correct-pattern {
            border: none !important; 
            background-color: var(--background-color) !important; 
            box-shadow: var(--shadow-light), var(--shadow-dark), 0 0 10px var(--error-color); /* Vurgu */
        }

        /* GÜNCELLENDİ: Rakam dairesi (İçine bastırılmış) */
        .pattern-number-circle {
            position: absolute;
            right: 8px; 
            top: 50%;
            transform: translateY(-50%);
            width: var(--circle-size);
            height: var(--circle-size);
            background-color: var(--background-color); 
            color: var(--text-color); 
            border: none; /* Sınır kaldırıldı */
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--circle-font-size);
            font-weight: bold;
            font-family: var(--font-family); 
            z-index: 3;
            line-height: 1; 
            /* GÜNCELLENDİ: 3D Bastırma efekti */
            box-shadow: var(--shadow-inset);
        }

        .l2-pattern-number {
            font-family: var(--font-family-arabic) !important;
            font-size: calc(var(--base-font-size) * 1.15); 
            font-weight: normal;
            color: var(--error-color); 
            position: absolute; 
            width: calc(100% - var(--circle-size) - 15px); 
            height: 100%; top: 0; left: 0; 
            display: flex; align-items: center; justify-content: center;
            gap: 40px; 
            direction: rtl;
            padding: 0 10px;
            pointer-events: none;
            transition: opacity 0.3s ease; 
        }
        .l2-pattern-number span { display: inline-block; line-height: 1; background-color: transparent; padding: 3px 6px; border-radius: 4px; }
        .l2-pattern-number.hidden { opacity: 0; }

        .l2-derived-word {
            font-family: var(--font-family-arabic) !important; 
            font-size: calc(var(--base-font-size) * 1.1); 
            font-weight: bold;
            color: var(--success-color); 
            text-align: center;
            line-height: 1.2;
            position: absolute;
            width: calc(100% - var(--circle-size) - 15px); 
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); 
            direction: rtl;
            padding: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px; 
        }
         .l2-derived-word span { 
            display: inline-block; 
            margin-left: 0; 
            font-size: 0.8em; 
            line-height: 1; 
         }

        #l2-global-result { 
            margin-top: 15px; 
            font-size: 1.1em; 
            color: var(--primary-color); 
            font-weight: 500; 
            min-height: 1.5em; 
            font-family: var(--font-family) !important; 
            flex-shrink: 0;
        }
        
         #l2-bottom-area {
            width: 100%;
            display: flex;
            justify-content: space-between; 
            align-items: center;
            margin-top: auto; 
            padding-top: 5px; 
            flex-shrink: 0;
            direction: ltr; 
        }
        
        /* GÜNCELLENDİ: İleri tuşu (3D Kabartma) */
        #next-button {
            align-self: center; 
            display: block;
            margin: 0;
            padding: 12px 28px; /* Biraz büyüdü */
            font-size: 1em;
            font-weight: bold;
            color: white;
            background-color: var(--success-color); 
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: var(--font-family) !important; 
            /* GÜNCELLENDİ: 3D Kabartma efekti */
            box-shadow: var(--shadow-light), var(--shadow-dark);
        }
        #next-button.pulse-on-appear {
            animation: pulse-appear 0.6s ease-out; 
        }

        #next-button:hover { 
            background-color: #218838; 
            transform: translateY(-2px); 
            box-shadow: -8px -8px 16px rgba(255, 255, 255, 1), 8px 8px 16px rgba(0, 0, 0, 0.1);
        }
        
        #next-button:active {
            box-shadow: var(--shadow-inset); /* Bastırma efekti */
            transform: translateY(1px);
        }
        
        .hidden { display: none !important; }

        /* GÜNCELLENDİ: Overlay (Mat yüzey) */
        .overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background-color: rgba(248, 249, 250, 0.97); /* Arka planla uyumlu */
            display: flex; justify-content: center; align-items: center; text-align: center; 
            z-index: 10; transition: opacity 0.3s, visibility 0.3s; 
            direction: ltr; padding: 15px; box-sizing: border-box; 
        }
        .overlay.hidden { opacity: 0; visibility: hidden; }
        
        /* GÜNCELLENDİ: Overlay içeriği (3D Kabartma) */
        .overlay-content { 
            background: var(--panel-background); 
            padding: 30px 40px; 
            border-radius: 20px; 
            box-shadow: var(--shadow-light), var(--shadow-dark); /* 3D Efekti */
            max-width: 90%; margin: auto; direction: ltr; text-align: center; 
        }
        #results-screen .overlay-content { padding-top: 40px; padding-bottom: 40px; }
        .overlay h1, .overlay h2 { color: var(--text-color); margin-top: 0; font-family: var(--font-family) !important; }
        .start-options { display: flex; justify-content: center; gap: 15px; margin-top: 25px; margin-bottom: 30px; flex-wrap: wrap; }
        
        /* GÜNCELLENDİ: Başlangıç butonu (3D Kabartma) */
        .start-button-option { 
            background-color: var(--primary-color); 
            color: white; border: none; padding: 12px 25px; 
            font-size: 1em; font-weight: bold; border-radius: 10px; 
            cursor: pointer; transition: all 0.2s ease; flex-shrink: 0; 
            font-family: var(--font-family) !important; 
            box-shadow: var(--shadow-light), var(--shadow-dark);
        }
        .start-button-option:hover { 
            background-color: #0056b3; 
            transform: translateY(-2px); 
            box-shadow: -8px -8px 16px rgba(255, 255, 255, 1), 8px 8px 16px rgba(0, 0, 0, 0.1);
        }
        .start-button-option:active {
            box-shadow: var(--shadow-inset);
            transform: translateY(1px);
        }
        .start-button-option:disabled { 
            background-color: var(--light-text-color); 
            cursor: not-allowed; transform: none; 
            box-shadow: none; opacity: 0.7; 
        }
        
        /* ... (Diğer stillerde büyük değişiklik yok) ... */
        .image-previews { display: flex; justify-content: center; gap: 20px; margin-top: 20px; perspective: 500px; flex-wrap: wrap; }
        .image-preview { text-align: center; margin-bottom: 15px; }
        .image-preview img { max-width: 150px; height: auto; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); transition: transform 0.3s ease; transform: rotateY(-10deg) rotateX(5deg); border: 1px solid var(--border-color); }
        .image-preview:nth-child(2) img { transform: rotateY(10deg) rotateX(5deg); }
        .image-preview img:hover { transform: scale(1.1) rotateY(0deg) rotateX(0deg); box-shadow: 0 8px 25px rgba(0,0,0,0.15); }
        .image-preview p { margin-top: 10px; font-size: 0.9em; color: var(--light-text-color); font-family: var(--font-family) !important; /* Marhey */ }

        #results-details { margin: 20px 0; text-align: center; min-width: auto; }
        #results-details p { font-family: var(--font-family) !important; /* Marhey */ }
        #results-details div { font-size: 1.6em !important; font-family: var(--font-family) !important; /* Marhey */ direction: ltr !important; text-align: center !important; color: var(--primary-color); line-height: 1.8; }
        #results-details div span { font-family: var(--font-family-arabic) !important; /* Harmattan */ font-size: 1.2em; margin-right: 10px; direction: rtl; }

        #play-again-button { 
            font-family: var(--font-family) !important; 
            /* Başlangıç butonuyla aynı stili verelim */
            background-color: var(--primary-color); 
            color: white; border: none; padding: 12px 25px; 
            font-size: 1em; font-weight: bold; border-radius: 10px; 
            cursor: pointer; transition: all 0.2s ease; flex-shrink: 0; 
            box-shadow: var(--shadow-light), var(--shadow-dark);
            margin-top: 15px;
        }
        #play-again-button:hover {
            background-color: #0056b3; 
            transform: translateY(-2px); 
            box-shadow: -8px -8px 16px rgba(255, 255, 255, 1), 8px 8px 16px rgba(0, 0, 0, 0.1);
        }

        #orientation-warning {
            background-color: var(--background-color);
            color: var(--text-color);
            z-index: 1001; 
            display: none; 
        }

        @keyframes shake { 10%, 90% { transform: translateX(-1px); } 20%, 80% { transform: translateX(2px); } 30%, 50%, 70% { transform: translateX(-4px); } 40%, 60% { transform: translateX(4px); } }
        
        /* GÜNCELLENDİ: Flash animasyonları (Arka planı değil, gölgeyi değiştirsin) */
        @keyframes flash-correct { 
            0%, 100% { box-shadow: var(--shadow-light), var(--shadow-dark); color: var(--text-color); } 
            50% { background-color: var(--success-color); color: white; box-shadow: none; } 
        }
        @keyframes flash-incorrect { 
            0%, 100% { box-shadow: var(--shadow-light), var(--shadow-dark); color: var(--text-color); } 
            50% { background-color: var(--error-color); color: white; box-shadow: none; } 
        }
        
        /* Eski pulse animasyonu kaldırıldı, yenisi eklendi */
        @keyframes pulse-vurgu-glass {
            0%, 100% { 
                transform: scale(1); 
                box-shadow: var(--shadow-light), var(--shadow-dark);
            }
            50% { 
                transform: scale(1.05); 
                box-shadow: -8px -8px 16px rgba(255, 255, 255, 1), 8px 8px 16px rgba(0, 0, 0, 0.1);
            }
        }
        @keyframes pulse-appear {
            0% { transform: scale(0.8); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Pembe ekler için kural */
        .highlight-suffix {
            color: #E91E63; /* Canlı pembe renk */
            font-size: 1.1em; /* Normal ek yazısından %10 daha büyük */
            font-weight: bold; /* Daha belirgin olması için */
        }


        /* *** GÜNCELLENDİ - Mobil Uyum (Flex Order ile) *** */
        @media (max-width: 600px) {
            :root { 
                --base-font-size: 1.7em; 
                --circle-size: 24px; 
                --circle-font-size: 0.65em; 
                
                --shadow-light: -5px -5px 10px rgba(255, 255, 255, 1);
                --shadow-dark: 5px 5px 10px rgba(0, 0, 0, 0.1);
                --shadow-inset: inset -3px -3px 6px rgba(255, 255, 255, 1), inset 3px 3px 6px rgba(0, 0, 0, 0.1);
            }

            #game-container { width: 98%; } 
            .overlay-content { padding: 20px 15px; }
            .start-options { flex-direction: column; }
            .image-previews { flex-direction: column; gap: 25px;}
            .image-preview img, .image-preview:nth-child(2) img { max-width: 100px; }
            
            #l2-patterns-wrapper { 
                grid-template-columns: 1fr 1fr; 
                grid-template-rows: auto; 
                max-height: none; 
                overflow-y: visible; 
                padding: 10px 5px; 
                gap: 10px; 
                order: 4; 
            }

            /* GÜNCELLENDİ: Kök kartı mobilde büyütüldü */
            .l2-draggable-root { 
                gap: 10px; /* Artırıldı */
                font-size: calc(var(--base-font-size) * 1.5); /* Artırıldı (1.05 idi) */
                padding: 10px 16px; /* Artırıldı (4px 8px idi) */
            }
            
            .l2-pattern-group { 
                min-height: calc(var(--base-font-size) * 2.5); 
                padding-right: calc(var(--circle-size) + 8px); 
            }
             
             .l2-pattern-number { 
                 font-size: calc(var(--base-font-size) * 0.85); 
                 width: calc(100% - var(--circle-size) - 12px); 
                 gap: 8px; 
             } 
             
            .l2-derived-word { 
                font-size: calc(var(--base-font-size) * 0.85); 
                width: calc(100% - var(--circle-size) - 12px); 
            }
             .l2-derived-word span { font-size: 0.7em; } 

            #level2-container { 
                max-height: 98vh; 
                overflow-y: auto; 
                padding: 10px 5px; 
            } 
            
            #l2-turkish-words-progress { 
                flex-direction: row; 
                flex-wrap: wrap; 
                justify-content: center; 
                gap: 6px; 
                padding: 5px;
                margin: 5px 0; 
                order: 1; 
            } 
            
            .l2-turkish-word { 
                font-size: 0.9em; 
                padding: 6px 10px; 
                margin: 2px; 
            } 

            #l2-root-area {
                display: flex; 
                flex-direction: column; 
                align-items: center; 
                gap: 8px; 
                padding: 5px 8px;
                margin-bottom: 2px; 
                order: 2; 
            }
            
            #l2-bottom-area {
                display: contents; 
            }
            
            .l2-passive-suffixes { 
                font-size: 1.6em; 
                text-align: center; 
                width: 100%; 
                margin-top: 10px; 
                margin-right: 0; 
                order: 6; 
            }
            
            #l2-draggable-root-wrapper { 
                width: auto; 
            }
            
            #next-button { 
                padding: 8px 15px; 
                font-size: 0.9em;
                align-self: center; 
                order: 7; 
                margin-top: 10px; 
            }
        
            .pattern-number-circle { right: 5px; } 

            #l2-mistakes { 
                order: 3; 
            }
            #l2-global-result {
                order: 5; 
            }
        }

        /* Yatay mod uyarısı */
        @media (max-height: 600px) and (orientation: landscape) {
            #game-container, #start-screen, #results-screen {
                display: none;
            }
            #orientation-warning {
                display: flex !important; /* hidden'ı ezmek için */
            }
        }
    </style>
    </head>
<body>
    <div id="game-container">
        <main id="level2-container">
            <div id="l2-turkish-words-progress"></div>
            
            <div id="l2-root-area"> 
                <div id="l2-draggable-root-wrapper"></div> 
            </div>
            
            <div id="l2-mistakes"></div>
            
            <div id="l2-patterns-wrapper"></div>
            
            <div id="l2-global-result"></div>

            <div id="l2-bottom-area">
                <div class="l2-passive-suffixes">  ـ ـ ـة - ـ ـ ة   |   ـ ـ ـيّ - ـ ـ ـيَّة   |   ـ ـ ـات  |   ـ ـ ـًا </div>
                <button id="next-button" class="hidden">İlerle ▶</button>
            </div>
            
        </main>

        <div id="start-screen" class="overlay"> 
            <div class="overlay-content"> 
                <h1>Kelimenin Serüveni</h1> 
                <h2>Seviye 2: Kökü Kalıba Yerleştir</h2> 
                <div class="image-previews"> 
                     <div class="image-preview"> <img src="sayfa1.png" alt="Kalıp Tablosu Sayfa 1"> <p>Kalıp Tablosu 1</p> </div> 
                     <div class="image-preview"> <img src="sayfa2.png" alt="Kalıp Tablosu Sayfa 2"> <p>Kalıp Tablosu 2</p> </div> 
                </div> 
                <div class="start-options"> 
                    <button class="start-button-option" data-mode="1"> Kendini Dene!</button> 
                </div> 
            </div> 
        </div>
        <div id="results-screen" class="overlay hidden"> <div class="overlay-content"> <h2 id="results-title">Oyun Bitti!</h2> <div id="results-details"></div> <button id="play-again-button">Ana Menüye Dön</button> </div> </div>
    
        <div id="orientation-warning" class="overlay">
            <div class="overlay-content">
                <h2>Lütfen Cihazı Dik Tutun</h2>
                <p>Bu oyun en iyi dikey modda çalışır.</p>
            </div>
        </div>
    </div>

<script>
    // GÜNCELLENDİ - Tüm kalıp ve kök verileri düzeltildi
    const embeddedGameData = {
      "patterns": { /* Kalıp verileri */ 
        "1": { "kalipNo": "1", "arapca": "فَعَلَ", "tur": "Mazi", "bab": "1. Bâb", "displayComponents": ["َ", "َ", "َ"], "steps": [] },
        "2": { "kalipNo": "2", "arapca": "يَفْعُلُ", "tur": "Muzari", "bab": "1. Bâb", "displayComponents": ["يَـ", "ْ", "ُ"], "steps": [] },
        "3": { "kalipNo": "3", "arapca": "أُفْعُلْ", "tur": "Emir", "bab": "1. Bâb", "displayComponents": ["اُ", "ْ", "ُ", "ْ"], "steps": [] },
        "4": { "kalipNo": "4", "arapca": "يَفْعِلُ", "tur": "Muzari", "bab": "2. Bâb", "displayComponents": ["يَـ", "ْ", "ِ"], "steps": [] },
        "5": { "kalipNo": "5", "arapca": "اِفْعِلْ", "tur": "Emir", "bab": "2. Bâb", "displayComponents": ["اِ", "ْ", "ِ", "ْ"], "steps": [] },
        "6": { "kalipNo": "6", "arapca": "يَفْعَلُ", "tur": "Muzari", "bab": "3. Bâb", "displayComponents": ["يَـ", "ْ", "َ"], "steps": [] },
        "7": { "kalipNo": "7", "arapca": "اِفْعَلْ", "tur": "Emir", "bab": "3. Bâb", "displayComponents": ["اِ", "ْ", "َ", "ْ"], "steps": [] },
        "8": { "kalipNo": "8", "arapca": "فَعِلَ", "tur": "Mazi", "bab": "4. Bâb", "displayComponents": ["َ", "ِ", "َ"], "steps": [] },
        "9": { "kalipNo": "9", "arapca": "يَفْعَلُ", "tur": "Muzari", "bab": "4. Bâb", "displayComponents": ["يَـ", "ْ", "َ"], "steps": [] },
        "10": { "kalipNo": "10", "arapca": "اِفْعَلْ", "tur": "Emir", "bab": "4. Bâb", "displayComponents": ["اِ", "ْ", "َ", "ْ"], "steps": [] },
        "11": { "kalipNo": "11", "arapca": "فَعُلَ", "tur": "Mazi", "bab": "5. Bâb", "displayComponents": ["َ", "ُ", "َ"], "steps": [] },
        "12": { "kalipNo": "12", "arapca": "يَفْعُلُ", "tur": "Muzari", "bab": "5. Bâb", "displayComponents": ["يَـ", "ْ", "ُ"], "steps": [] },
        "13": { "kalipNo": "13", "arapca": "أُفْعُلْ", "tur": "Emir", "bab": "5. Bâb", "displayComponents": ["اُ", "ْ", "ُ", "ْ"], "steps": [] },
        "14": { "kalipNo": "14", "arapca": "فَعِلَ", "tur": "Mazi", "bab": "6. Bâb", "displayComponents": ["َ", "ِ", "َ"], "steps": [] },
        "15": { "kalipNo": "15", "arapca": "يَفْعِلُ", "tur": "Muzari", "bab": "6. Bâb", "displayComponents": ["يَـ", "ْ", "ِ"], "steps": [] },
        "16": { "kalipNo": "16", "arapca": "اِفْعَلْ", "tur": "Emir", "bab": "6. Bâb", "displayComponents": ["اِ", "ْ", "َ", "ْ"], "steps": [] },
        "17": { "kalipNo": "17", "arapca": "فَعَلَ", "tur": "İsim/Sıfat", "bab": "Sülâsî İsim", "displayComponents": ["َ", "َ"], "steps": [] }, 
        "18": { "kalipNo": "18", "arapca": "فَعِلَ", "tur": "İsim/Sıfat", "bab": "Sülâsî İsim", "displayComponents": ["َ", "ِ", "َ"], "steps": [] },
        "19": { "kalipNo": "19", "arapca": "فَعْل", "tur": "Masdar/İsim", "bab": "Sülâsî İsim", "displayComponents": ["َ", "ْ"], "steps": [] },
        "20": { "kalipNo": "20", "arapca": "فِعْل", "tur": "Masdar/İsim", "bab": "Sülâsî İsim", "displayComponents": ["ِ", "ْ"], "steps": [] },
        "21": { "kalipNo": "21", "arapca": "فُعْل", "tur": "Masdar/İsim", "bab": "Sülâsî İsim", "displayComponents": ["ُ", "ْ"], "steps": [] },
        "22": { "kalipNo": "22", "arapca": "فَعَال", "tur": "İsim/Sıfat", "bab": "Sülâsî İsim", "displayComponents": ["َ", "َ", "ا"], "steps": [] },
        "23": { "kalipNo": "23", "arapca": "فِعَال", "tur": "İsim/Sıfat", "bab": "Sülâsî İsim", "displayComponents": ["ِ", "َ", "ا"], "steps": [] },
        "24": { "kalipNo": "24", "arapca": "فُعَال", "tur": "İsim/Sıfat", "bab": "Sülâsî İsim", "displayComponents": ["ُ", "َ", "ا"], "steps": [] },
        "25": { "kalipNo": "25", "arapca": "فُعُول", "tur": "İsim/Sıfat", "bab": "Sülâsî İsim", "displayComponents": ["ُ", "ُ", "و"], "steps": [] },
        "26": { "kalipNo": "26", "arapca": "فَعُول", "tur": "İsim/Sıfat", "bab": "Sülâsî İsim", "displayComponents": ["َ", "ُ", "و"], "steps": [] },
        "27": { "kalipNo": "27", "arapca": "فُعْلَان", "tur": "İsim/Sıfat", "bab": "Sülâsî İsim", "displayComponents": ["ُ", "ْ", "َ", "ان"], "steps": [] },
        "28": { "kalipNo": "28", "arapca": "فَعْلَان", "tur": "İsim/Sıfat", "bab": "Sülâsî İsim", "displayComponents": ["َ", "ْ", "َ", "ان"], "steps": [] },
        "29": { "kalipNo": "29", "arapca": "فِعْلَان", "tur": "İsim/Sıfat", "bab": "Sülâsî İsim", "displayComponents": ["ِ", "ْ", "َ", "ان"], "steps": [] },
        "30": { "kalipNo": "30", "arapca": "أَفْعَل", "tur": "Sıfat", "bab": "Sülâsî İsim", "displayComponents": ["أَ", "ْ", "َ"], "steps": [] },
        "31": { "kalipNo": "31", "arapca": "فَعْلَاء", "tur": "Sıfat", "bab": "Sülâsî İsim", "displayComponents": ["َ", "ْ", "َ", "اء"], "steps": [] },
        "32": { "kalipNo": "32", "arapca": "فَعْلَى", "tur": "Sıfat", "bab": "Sülâsî İsim", "displayComponents": ["َ", "ْ", "َ", "ى"], "steps": [] },
        "33": { "kalipNo": "33", "arapca": "فَاعِل", "tur": "İsm-i Fâil", "bab": "Sülâsî İsim", "displayComponents": ["َ", "ا", "ِ"], "steps": [] },
        "34": { "kalipNo": "34", "arapca": "فَعَّال", "tur": "Müb. Fail/Meslek", "bab": "Sülâsî İsim", "displayComponents": ["َ", "َّ", "ا"], "steps": [] },
        "35": { "kalipNo": "35", "arapca": "فَعِيل", "tur": "Sıfat-ı Müş.", "bab": "Sülâsî İsim", "displayComponents": ["َ", "ِ", "ـيـ"], "steps": [] },
        "36": { "kalipNo": "36", "arapca": "مَفْعُول", "tur": "İsm-i Mef'ûl", "bab": "Sülâsî İsim", "displayComponents": ["مَـ", "ْ", "ُ", "و"], "steps": [] },
        "37": { "kalipNo": "37", "arapca": "مَفْعِل", "tur": "İsm-i Zaman/Mekan", "bab": "Sülâsî İsim", "displayComponents": ["مَـ", "ْ", "ِ"], "steps": [] },
        "38": { "kalipNo": "38", "arapca": "مَفْعَل", "tur": "İsm-i Zaman/Mekan", "bab": "Sülâsî İsim", "displayComponents": ["مَـ", "ْ", "َ"], "steps": [] },
        "39": { "kalipNo": "39", "arapca": "مِفْعَل", "tur": "İsm-i Âlet", "bab": "Sülâsî İsim", "displayComponents": ["مِـ", "ْ", "َ"], "steps": [] },
        "40": { "kalipNo": "40", "arapca": "مِفْعَال", "tur": "İsm-i Âlet/Müb. Fail", "bab": "Sülâsî İsim", "displayComponents": ["مِـ", "ْ", "َ", "ا"], "steps": [] },
        "41": { "kalipNo": "41", "arapca": "أَفْعَال", "tur": "Cem-i Teksir", "bab": "Sülâsî İsim", "displayComponents": ["أَ", "ْ", "َ", "ا"], "steps": [] },
        "42": { "kalipNo": "42", "arapca": "فُعُل", "tur": "Cem-i Teksir", "bab": "Sülâsî İsim", "displayComponents": ["ُ", "ُ"], "steps": [] },
        "43": { "kalipNo": "43", "arapca": "فُعُول", "tur": "Masdar/Cem-i Teksir", "bab": "Sülâsî İsim", "displayComponents": ["ُ", "ُ", "و"], "steps": [] },
        "44": { "kalipNo": "44", "arapca": "فِعَال", "tur": "Masdar/Cem-i Teksir", "bab": "Sülâsî İsim", "displayComponents": ["ِ", "َ", "ا"], "steps": [] },
        "45": { "kalipNo": "45", "arapca": "فُعَّال", "tur": "Cem-i Teksir", "bab": "Sülâsî İsim", "displayComponents": ["ُ", "َّ", "ا"], "steps": [] },
        "46": { "kalipNo": "46", "arapca": "فُعَلَاء", "tur": "Cem-i Teksir", "bab": "Sülâsî İsim", "displayComponents": ["ُ", "َ", "َ", "اء"], "steps": [] },
        "47": { "kalipNo": "47", "arapca": "فَعَلَة", "tur": "Cem-i Teksir", "bab": "Sülâsî İsim", "displayComponents": ["َ", "َ", "َ", "َة"], "steps": [] },
        "48": { "kalipNo": "48", "arapca": "فَعَائِل", "tur": "Cem-i Teksir", "bab": "Sülâsî İsim", "displayComponents": ["َ", "َ", "ا", "ئِـ"], "steps": [] },
        "49": { "kalipNo": "49", "arapca": "فُعَيْل", "tur": "İsm-i Tasgîr", "bab": "Sülâsî İsim", "displayComponents": ["ُ", "َ", "ـيْـ"], "steps": [] },
        "50": { "kalipNo": "50", "arapca": "أَفْعَل", "tur": "İsm-i Tafdîl/Sıfat", "bab": "Sülâsî İsim", "displayComponents": ["أَ", "ْ", "َ"], "steps": [] },
        "51": { "kalipNo": "51", "arapca": "فُعْلَى", "tur": "İsm-i Tafdîl(Müen.)", "bab": "Sülâsî İsim", "displayComponents": ["ُ", "ْ", "َ", "ى"], "steps": [] },
        "52": { "kalipNo": "52", "arapca": "أَفْعَلَ", "tur": "Mazi", "bab": "İf'âl", "displayComponents": ["أَ", "ْ", "َ", "َ"], "steps": [] },
        "53": { "kalipNo": "53", "arapca": "يُفْعِلُ", "tur": "Muzari", "bab": "İf'âl", "displayComponents": ["يُـ", "ْ", "ِ"], "steps": [] },
        "54": { "kalipNo": "54", "arapca": "أَفْعِلْ", "tur": "Emir", "bab": "İf'âl", "displayComponents": ["أَ", "ْ", "ِ", "ْ"], "steps": [] },
        "55": { "kalipNo": "55", "arapca": "إِفْعَال", "tur": "Masdar", "bab": "İf'âl", "displayComponents": ["إِ", "ْ", "َ", "ا"], "steps": [] },
        "56": { "kalipNo": "56", "arapca": "مُفْعِل", "tur": "İsm-i Fâil", "bab": "İf'âl", "displayComponents": ["مُـ", "ْ", "ِ"], "steps": [] },
        "57": { "kalipNo": "57", "arapca": "مُفْعَل", "tur": "İsm-i Mef'ûl", "bab": "İf'âl", "displayComponents": ["مُـ", "ْ", "َ"], "steps": [] },
        "58": { "kalipNo": "58", "arapca": "فَعَّلَ", "tur": "Mazi", "bab": "Tef'îl", "displayComponents": ["َ", "َّ", "َ"], "steps": [] },
        "59": { "kalipNo": "59", "arapca": "يُفَعِّلُ", "tur": "Muzari", "bab": "Tef'îl", "displayComponents": ["يُـ", "َ", "ِّ"], "steps": [] },
        "60": { "kalipNo": "60", "arapca": "فَعِّلْ", "tur": "Emir", "bab": "Tef'îl", "displayComponents": ["َ", "ِّ", "ْ"], "steps": [] },
        "61": { "kalipNo": "61", "arapca": "تَفْعِيل", "tur": "Masdar", "bab": "Tef'îl", "displayComponents": ["تَـ", "ْ", "ِ", "ـيـ"], "steps": [] },
        "62": { "kalipNo": "62", "arapca": "مُفَعِّل", "tur": "İsm-i Fâil", "bab": "Tef'îl", "displayComponents": ["مُـ", "َ", "ِّ"], "steps": [] },
        "63": { "kalipNo": "63", "arapca": "مُفَعَّل", "tur": "İsm-i Mef'ûl", "bab": "Tef'îl", "displayComponents": ["مُـ", "َ", "َّ"], "steps": [] },
        "64": { "kalipNo": "64", "arapca": "فَاعَلَ", "tur": "Mazi", "bab": "Mufâ'ale", "displayComponents": ["َ", "ا", "َ", "َ"], "steps": [] },
        "65": { "kalipNo": "65", "arapca": "يُفَاعِلُ", "tur": "Muzari", "bab": "Mufâ'ale", "displayComponents": ["يُـ", "َ", "ا", "ِ"], "steps": [] },
        "66": { "kalipNo": "66", "arapca": "فَاعِلْ", "tur": "Emir", "bab": "Mufâ'ale", "displayComponents": ["َ", "ا", "ِ", "ْ"], "steps": [] },
        "67": { "kalipNo": "67", "arapca": "مُفَاعَلَة", "tur": "Masdar", "bab": "Mufâ'ale", "displayComponents": ["مُـ", "َ", "ا", "َ", "َة"], "steps": [] },
        "68": { "kalipNo": "68", "arapca": "فِعَال", "tur": "Masdar", "bab": "Mufâ'ale", "displayComponents": ["ِ", "َ", "ا"], "steps": [] },
        "69": { "kalipNo": "69", "arapca": "مُفَاعِل", "tur": "İsm-i Fâil", "bab": "Mufâ'ale", "displayComponents": ["مُـ", "َ", "ا", "ِ"], "steps": [] },
        "70": { "kalipNo": "70", "arapca": "مُفَاعَل", "tur": "İsm-i Mef'ûl", "bab": "Mufâ'ale", "displayComponents": ["مُـ", "َ", "ا", "َ"], "steps": [] },
        "71": { "kalipNo": "71", "arapca": "اِنْفَعَلَ", "tur": "Mazi", "bab": "İnfi'âl", "displayComponents": ["اِنْـ", "َ", "َ", "َ"], "steps": [] },
        "72": { "kalipNo": "72", "arapca": "يَنْفَعِلُ", "tur": "Muzari", "bab": "İnfi'âl", "displayComponents": ["يَنْـ", "َ", "ِ"], "steps": [] },
        "73": { "kalipNo": "73", "arapca": "اِنْفَعِلْ", "tur": "Emir", "bab": "İnfi'âl", "displayComponents": ["اِنْـ", "َ", "ِ", "ْ"], "steps": [] },
        "74": { "kalipNo": "74", "arapca": "اِنْفِعَال", "tur": "Masdar", "bab": "İnfi'âl", "displayComponents": ["اِنْـ", "ِ", "َ", "ا"], "steps": [] },
        "75": { "kalipNo": "75", "arapca": "مُنْفَعِل", "tur": "İsm-i Fâil", "bab": "İnfi'âl", "displayComponents": ["مُنْـ", "َ", "ِ"], "steps": [] },
        "76": { "kalipNo": "76", "arapca": "مُنْفَعَل", "tur": "İsm-i Mef'ûl", "bab": "İnfi'âl", "displayComponents": ["مُنْـ", "َ", "َ"], "steps": [] },
        "77": { "kalipNo": "77", "arapca": "اِفْتَعَلَ", "tur": "Mazi", "bab": "İfti'âl", "displayComponents": ["اِ", "ْ", "تَ", "َ", "َ"], "steps": [] },
        "78": { "kalipNo": "78", "arapca": "يَفْتَعِلُ", "tur": "Muzari", "bab": "İfti'âl", "displayComponents": ["يَـ", "ْ", "تَ", "ِ", "ُ"], "steps": [] },
        "79": { "kalipNo": "79", "arapca": "اِفْتَعِلْ", "tur": "Emir", "bab": "İfti'âl", "displayComponents": ["اِ", "ْ", "تَ", "ِ", "ْ"], "steps": [] },
        "80": { "kalipNo": "80", "arapca": "اِفْتِعَال", "tur": "Masdar", "bab": "İfti'âl", "displayComponents": ["اِ", "ْ", "تِ", "َ", "ا"], "steps": [] },
        "81": { "kalipNo": "81", "arapca": "مُفْتَعِل", "tur": "İsm-i Fâil", "bab": "İfti'âl", "displayComponents": ["مُـ", "ْ", "تَ", "ِ"], "steps": [] },
        "82": { "kalipNo": "82", "arapca": "مُفْتَعَل", "tur": "İsm-i Mef'ûl", "bab": "İfti'âl", "displayComponents": ["مُـ", "ْ", "تَ", "َ"], "steps": [] },
        "83": { "kalipNo": "83", "arapca": "اِفْعَلَّ", "tur": "Mazi", "bab": "İf'ilâl", "displayComponents": ["اِ", "ْ", "َ", "َّ"], "steps": [] },
        "84": { "kalipNo": "84", "arapca": "يَفْعَلُّ", "tur": "Muzari", "bab": "İf'ilâl", "displayComponents": ["يَـ", "ْ", "َ", "ُّ"], "steps": [] },
        "85": { "kalipNo": "85", "arapca": "اِفْعَلِلْ", "tur": "Emir", "bab": "İf'ilâl", "displayComponents": ["اِ", "ْ", "َ", "ِ", "لْ"], "steps": [] },
        "86": { "kalipNo": "86", "arapca": "اِفْعِلَال", "tur": "Masdar", "bab": "İf'ilâl", "displayComponents": ["اِ", "ْ", "ِ", "َّ", "ا"], "steps": [] },
        "87": { "kalipNo": "87", "arapca": "مُفْعِلّ", "tur": "İsm-i Fâil", "bab": "İf'ilâl", "displayComponents": ["مُـ", "ْ", "َ", "ِّ"], "steps": [] },
        "88": { "kalipNo": "88", "arapca": "تَفَعَّلَ", "tur": "Mazi", "bab": "Tefe''ul", "displayComponents": ["تَـ", "َ", "َّ", "َ"], "steps": [] },
        "89": { "kalipNo": "89", "arapca": "يَتَفَعَّلُ", "tur": "Muzari", "bab": "Tefe''ul", "displayComponents": ["يَتَـ", "َ", "َّ"], "steps": [] },
        "90": { "kalipNo": "90", "arapca": "تَفَعَّلْ", "tur": "Emir", "bab": "Tefe''ul", "displayComponents": ["تَـ", "َ", "َّ", "ْ"], "steps": [] },
        "91": { "kalipNo": "91", "arapca": "تَفَعُّل", "tur": "Masdar", "bab": "Tefe''ul", "displayComponents": ["تَـ", "َ", "ُّ"], "steps": [] },
        "92": { "kalipNo": "92", "arapca": "مُتَفَعِّل", "tur": "İsm-i Fâil", "bab": "Tefe''ul", "displayComponents": ["مُتَـ", "َ", "ِّ"], "steps": [] },
        "93": { "kalipNo": "93", "arapca": "مُتَفَعَّل", "tur": "İsm-i Mef'ûl", "bab": "Tefe''ul", "displayComponents": ["مُتَـ", "َ", "َّ"], "steps": [] },
        "94": { "kalipNo": "94", "arapca": "تَفَاعَلَ", "tur": "Mazi", "bab": "Tefâ'ul", "displayComponents": ["تَـ", "َ", "ا", "َ", "َ"], "steps": [] },
        "95": { "kalipNo": "95", "arapca": "يَتَفَاعَلُ", "tur": "Muzari", "bab": "Tefâ'ul", "displayComponents": ["يَتَـ", "َ", "ا", "َ"], "steps": [] },
        "96": { "kalipNo": "96", "arapca": "تَفَاعَلْ", "tur": "Emir", "bab": "Tefâ'ul", "displayComponents": ["تَـ", "َ", "ا", "َ", "ْ"], "steps": [] },
        "97": { "kalipNo": "97", "arapca": "تَفَاعُل", "tur": "Masdar", "bab": "Tefâ'ul", "displayComponents": ["تَـ", "َ", "ا", "ُ"], "steps": [] },
        "98": { "kalipNo": "98", "arapca": "مُتَفَاعِل", "tur": "İsm-i Fâil", "bab": "Tefâ'ul", "displayComponents": ["مُتَـ", "َ", "ا", "ِ"], "steps": [] },
        "99": { "kalipNo": "99", "arapca": "مُتَفَاعَل", "tur": "İsm-i Mef'ûl", "bab": "Tefâ'ul", "displayComponents": ["مُتَـ", "َ", "ا", "َ"], "steps": [] },
        "100": { "kalipNo": "100", "arapca": "اِسْتَفْعَلَ", "tur": "Mazi", "bab": "İstif'âl", "displayComponents": ["اِسْتَـ", "َ", "َ", "َ"], "steps": [] },
        "101": { "kalipNo": "101", "arapca": "يَسْتَفْعِلُ", "tur": "Muzari", "bab": "İstif'âl", "displayComponents": ["يَسْتَـ", "ْ", "ِ"], "steps": [] },
        "102": { "kalipNo": "102", "arapca": "اِسْتَفْعِلْ", "tur": "Emir", "bab": "İstif'âl", "displayComponents": ["اِسْتَـ", "ْ", "ِ", "ْ"], "steps": [] },
        "103": { "kalipNo": "103", "arapca": "اِسْتِفْعَال", "tur": "Masdar", "bab": "İstif'âl", "displayComponents": ["اِسْتِـ", "ْ", "َ", "ا"], "steps": [] },
        "104": { "kalipNo": "104", "arapca": "مُسْتَفْعِل", "tur": "İsm-i Fâil", "bab": "İstif'âl", "displayComponents": ["مُسْتَـ", "ْ", "ِ"], "steps": [] },
        "105": { "kalipNo": "105", "arapca": "مُسْتَفْعَل", "tur": "İsm-i Mef'ûl", "bab": "İstif'âl", "displayComponents": ["مُسْتَـ", "ْ", "َ"], "steps": [] }
      },
      "roots": { /* Kök ve kelime verileri */ 
        "ح-ك-م": { "root": ["ح", "ك", "م"], "words": [ { "arapca": "حَاكِم", "turkce": "Hâkim 🧑‍⚖️", "kalipNo": "33" }, { "arapca": "حَكِيم", "turkce": "Hekîm 👨‍⚕️", "kalipNo": "35" }, { "arapca": "مَحْكُوم", "turkce": "Mahkum ⛓️", "kalipNo": "36" } ] },
        "ع-ر-ف": { "root": ["ع", "ر", "ف"], "words": [ { "arapca": "عِرْفَان", "turkce": "İrfan 💡", "kalipNo": "29" }, { "arapca": "عَارِف", "turkce": "Arif 🧠", "kalipNo": "33" }, { "arapca": "تَعْرِيف", "turkce": "Tarif 📝", "kalipNo": "61" } ] },
        "ع-ل-م": { "root": ["ع", "ل", "م"], "words": [ { "arapca": "عَالِم", "turkce": "Âlim 🎓", "kalipNo": "33" }, { "arapca": "تَعْلِيم", "turkce": "Talim 🧑‍🏫", "kalipNo": "61" }, { "arapca": "مُعَلِّم", "turkce": "Muallim 👨‍🏫", "kalipNo": "62" } ] },
        "ر-ح-م": { "root": ["ر", "ح", "م"], "words": [ { "arapca": "رَحِيم", "turkce": "Rahîm 💖", "kalipNo": "35" }, { "arapca": "مَرْحُوم", "turkce": "Merhum 🪦", "kalipNo": "36" }, { "arapca": "اِسْتِرْحَام", "turkce": "İstirham 🙏", "kalipNo": "103" } ] },
        "ح-ف-ظ": { "root": ["ح", "ف", "ظ"], "words": [ { "arapca": "حَافِظ", "turkce": "Hâfız 📖", "kalipNo": "33" }, { "arapca": "مُحَافَظَة", "turkce": "Muhafaza 🛡️", "kalipNo": "67" }, { "arapca": "مُحَافِظ", "turkce": "Muhafız 💂", "kalipNo": "69" } ] },
        "ك-ت-ب": { "root": ["ك", "ت", "ب"], "words": [ { "arapca": "كِتَاب", "turkce": "Kitap 📚", "kalipNo": "23" }, { "arapca": "مَكْتُوب", "turkce": "Mektup ✉️", "kalipNo": "36" }, { "arapca": "كَاتِب", "turkce": "Katip ✍️", "kalipNo": "33" }, { "arapca": "كِتَابَة", "turkce": "Kitabe 📜", "kalipNo": "23" }, { "arapca": "مَكْتَب", "turkce": "Mekteb 🏫", "kalipNo": "38" } ] },
        "ن-ظ-ر": { "root": ["ن", "ظ", "ر"], "words": [ { "arapca": "نَظَر", "turkce": "Nazar 👀", "kalipNo": "17" }, { "arapca": "مُنَاظَرَة", "turkce": "Münazara 🗣️", "kalipNo": "67" }, { "arapca": "اِنْتِظَار", "turkce": "İntizar ⏳", "kalipNo": "80" } ] },
        "م-ك-ن": { "root": ["م", "ك", "ن"], "words": [ { "arapca": "إِمْكَان", "turkce": "İmkân ✨", "kalipNo": "55" }, { "arapca": "مُمْكِن", "turkce": "Mümkün ✅", "kalipNo": "56" }, { "arapca": "تَمْكِين", "turkce": "Temkin 🧐", "kalipNo": "61" } ] },
        "ح-س-ن": { "root": ["ح", "س", "ن"], "words": [ { "arapca": "حَسَن", "turkce": "Hasan 😊", "kalipNo": "17" }, { "arapca": "حُسَيْن", "turkce": "Hüseyin 🧒", "kalipNo": "49" }, { "arapca": "أَحْسَن", "turkce": "Ahsen 🌟", "kalipNo": "30" }, { "arapca": "حُسْنَى", "turkce": "Hüsna 🌸", "kalipNo": "51" }, { "arapca": "إِحْسَان", "turkce": "İhsan ❤️", "kalipNo": "55" }, { "arapca": "مُحْسِن", "turkce": "Muhsin 🥰", "kalipNo": "56" }, { "arapca": "تَحْسِين", "turkce": "Tahsin 👍", "kalipNo": "61" } ] },
        "س-ع-د": { "root": ["س", "ع", "د"], "words": [ { "arapca": "سَعَادَة", "turkce": "Saadet 🥳", "kalipNo": "22" }, { "arapca": "سُعَاد", "turkce": "Suad 😌", "kalipNo": "24" }, { "arapca": "سَعِيد", "turkce": "Said 😀", "kalipNo": "35" }, { "arapca": "مَسْعُود", "turkce": "Mesud 😁", "kalipNo": "36" } ] },
        "ج-ه-ل": { "root": ["ج", "ه", "ل"], "words": [ { "arapca": "جَاهِل", "turkce": "Câhil 🤷", "kalipNo": "33" }, { "arapca": "جَاهِلِيَّة", "turkce": "Câhiliye 🏺", "kalipNo": "33" }, { "arapca": "مَجْهُول", "turkce": "Meçhul ❓", "kalipNo": "36" }, { "arapca": "جُهَلَاء", "turkce": "Cühela 👥", "kalipNo": "46" } ] },
        "و-ج-د": { "root": ["و", "ج", "د"], "words": [ { "arapca": "وُجُود", "turkce": "Vücud 🧘", "kalipNo": "25" }, { "arapca": "وِجْدَان", "turkce": "Vicdan 💖", "kalipNo": "29" }, { "arapca": "مَوْجُود", "turkce": "Mevcud 📍", "kalipNo": "36" }, { "arapca": "إِيجَاد", "turkce": "İcad 💡", "kalipNo": "55" }, { "arapca": "مُوجِد", "turkce": "Mucid 👨‍🔬", "kalipNo": "56" } ] },
        "س-ك-ن": { "root": ["س", "ك", "ن"], "words": [ { "arapca": "سَاكِن", "turkce": "Sakin 🏠", "kalipNo": "33" }, { "arapca": "مَسْكُون", "turkce": "Meskûn 🏘️", "kalipNo": "36" }, { "arapca": "مَسْكَن", "turkce": "Mesken 🏡", "kalipNo": "38" }, { "arapca": "إِسْكَان", "turkce": "İskân 🏗️", "kalipNo": "55" }, { "arapca": "تَسْكِين", "turkce": "Teskin 😌", "kalipNo": "61" } ] },
        "ج-ه-د": { "root": ["ج", "ه", "د"], "words": [ { "arapca": "جَاهِد", "turkce": "Câhit 💪", "kalipNo": "33" }, { "arapca": "جِهَاد", "turkce": "Cihât ⚔️", "kalipNo": "68" }, { "arapca": "مُجَاهِد", "turkce": "Mücâhit 🛡️", "kalipNo": "69" }, { "arapca": "اِجْتِهَاد", "turkce": "İçtihât ⚖️", "kalipNo": "80" }, { "arapca": "مُجْتَهِد", "turkce": "Müçtehid 👨‍⚖️", "kalipNo": "81" } ] },
        "س-ل-م": { "root": ["س", "ل", "م"], "words": [ { "arapca": "سَلَام", "turkce": "Selam 🕊️", "kalipNo": "22" }, { "arapca": "سَلَامَة", "turkce": "Selamet 🛡️", "kalipNo": "22" }, { "arapca": "سَالِم", "turkce": "Salim ✅", "kalipNo": "33" }, { "arapca": "سَلِيم", "turkce": "Selim 😊", "kalipNo": "35" }, { "arapca": "إِسْلَام", "turkce": "İslam ☪️", "kalipNo": "55" }, { "arapca": "مُسْلِم", "turkce": "Müslim 🕌", "kalipNo": "56" }, { "arapca": "تَسْلِيم", "turkce": "Teslim 🤝", "kalipNo": "61" } ] },
        "ق-ر-ب": { "root": ["ق", "ر", "ب"], "words": [ { "arapca": "قُرْبَان", "turkce": "Kurban 🐑", "kalipNo": "27" }, { "arapca": "أَقْرَب", "turkce": "Akreb ➡️", "kalipNo": "30" }, { "arapca": "تَقْرِيبًا", "turkce": "Takriben 📐", "kalipNo": "61" } ] },
        "ن-ظ-م": { "root": ["ن", "ظ", "م"], "words": [ { "arapca": "نَظْم", "turkce": "Nazım 📜", "kalipNo": "19" }, { "arapca": "نِظَام", "turkce": "Nizam ⚖️", "kalipNo": "23" }, { "arapca": "نَاظِم", "turkce": "Nâzım ✍️", "kalipNo": "33" }, { "arapca": "مَنْظُوم", "turkce": "Manzum 🎶", "kalipNo": "36" }, { "arapca": "تَنْظِيم", "turkce": "Tanzim 🗂️", "kalipNo": "61" }, { "arapca": "اِنْتِظَام", "turkce": "İntizam 📏", "kalipNo": "80" }, { "arapca": "مُنْتَظَمًا", "turkce": "Muntazam ✨", "kalipNo": "82" } ] },
        "د-خ-ل": { "root": ["د", "خ", "ل"], "words": [ { "arapca": "دَاخِل", "turkce": "Dâhil ➡️", "kalipNo": "33" }, { "arapca": "دَاخِلِيَّة", "turkce": "Dâhiliye 🏥", "kalipNo": "33" }, { "arapca": "إِدْخَال", "turkce": "İthal 📥", "kalipNo": "55" }, { "arapca": "إِدْخَالَات", "turkce": "İthalat 📦", "kalipNo": "55" }, { "arapca": "مُدَاخَلَة", "turkce": "Müdahale ✋", "kalipNo": "67" } ] },
        "ر-ك-ب": { "root": ["ر", "ك", "ب"], "words": [ { "arapca": "مَرْكَب", "turkce": "Merkeb 🐴", "kalipNo": "38" }, { "arapca": "تَرْكِيب", "turkce": "Terkib 🧪", "kalipNo": "61" }, { "arapca": "مُرَكَّب", "turkce": "Mürekkeb ✒️", "kalipNo": "63" } ] },
        "ط-ب-ق": { "root": ["ط", "ب", "ق"], "words": [ { "arapca": "طَبَقَة", "turkce": "Tabaka 層", "kalipNo": "17" }, { "arapca": "تَطْبِيق", "turkce": "Tatbik 🛠️", "kalipNo": "61" }, { "arapca": "تَطْبِيقَات", "turkce": "Tatbikat 🏋️", "kalipNo": "61" }, { "arapca": "مُطَابَقَات", "turkce": "Mutabakat 🤝", "kalipNo": "67" }, { "arapca": "مُطَابِق", "turkce": "Mutabık ✅", "kalipNo": "69" } ] },
        "ن-ق-ل": { "root": ["ن", "ق", "ل"], "words": [ { "arapca": "نَقْلًا", "turkce": "Naklen ➡️", "kalipNo": "19" }, { "arapca": "نَقْلِيَّة", "turkce": "Nakliye 🚚", "kalipNo": "19" }, { "arapca": "نَقِيل", "turkce": "Nakil 🔄", "kalipNo": "35" }, { "arapca": "مَنْقُول", "turkce": "Menkul", "kalipNo": "36" }, { "arapca": "اِنْتِقَال", "turkce": "İntikal ↪️", "kalipNo": "80" } ] },
        "ش-ر-ب": { "root": ["ش", "ر", "ب"], "words": [ { "arapca": "شَرْبَة", "turkce": "Şerbet 🍹", "kalipNo": "19" }, { "arapca": "شَرَاب", "turkce": "Şarâp 🍷", "kalipNo": "22" }, { "arapca": "شُرُوب", "turkce": "Şurub 🍾", "kalipNo": "26" }, { "arapca": "مَشْرُوبَات", "turkce": "Meşrubat 🥤", "kalipNo": "36" }, { "arapca": "مَشْرَب", "turkce": "Meşreb 🌿", "kalipNo": "38" } ] },
        "ر-ج-ع": { "root": ["ر", "ج", "ع"], "words": [ { "arapca": "مَرْجِع", "turkce": "Merci ↩️", "kalipNo": "37" }, { "arapca": "مُرَاجَعَة", "turkce": "Müracaat 📝", "kalipNo": "67" }, { "arapca": "اِرْتِجَاع", "turkce": "İrtica 🔙", "kalipNo": "80" } ] },
        "ش-ك-ل": { "root": ["ش", "ك", "ل"], "words": [ { "arapca": "شَكْل", "turkce": "Şekl 🧩", "kalipNo": "19" }, { "arapca": "أَشْكَال", "turkce": "Eşkal 🔶", "kalipNo": "41" }, { "arapca": "مُشْكِل", "turkce": "Müşkil 🤔", "kalipNo": "56" }, { "arapca": "تَشْكِيل", "turkce": "Teşkil 🧬", "kalipNo": "61" }, { "arapca": "تَشْكِيلَات", "turkce": "Teşkilat 👥", "kalipNo": "61" } ] },
        "ن-س-ب": { "root": ["ن", "س", "ب"], "words": [ { "arapca": "نَسَب", "turkce": "Neseb 👨‍👩‍👧‍👦", "kalipNo": "17" }, { "arapca": "نِسْبَة", "turkce": "Nisbet 📊", "kalipNo": "20" }, { "arapca": "مَنْسُوب", "turkce": "Mensub 🔗", "kalipNo": "36" }, { "arapca": "مُنَاسَبَة", "turkce": "Münasebet 🎉", "kalipNo": "67" }, { "arapca": "اِنْتِسَاب", "turkce": "İntisab 🖇️", "kalipNo": "80" } ] },
        "ش-ه-د": { "root": ["ش", "ه", "د"], "words": [ { "arapca": "شَهَادَة", "turkce": "Şehadet 📜", "kalipNo": "22" }, { "arapca": "شَاهِد", "turkce": "Şâhit 👀", "kalipNo": "33" }, { "arapca": "شَهِيد", "turkce": "Şehît 🌺", "kalipNo": "35" }, { "arapca": "شُهَدَاء", "turkce": "Şüheda 🌷", "kalipNo": "46" }, { "arapca": "مُشَاهَدَة", "turkce": "Müşahede 🔬", "kalipNo": "67" } ] },
        "ب-ر-ك": { "root": ["ب", "ر", "ك"], "words": [ { "arapca": "بَرَكَة", "turkce": "Bereket 🌾", "kalipNo": "17" }, { "arapca": "تَبْرِيك", "turkce": "Tebrik 🎉", "kalipNo": "61" }, { "arapca": "مُبَارَك", "turkce": "Mübarek ✨", "kalipNo": "70" }, { "arapca": "تَبَرُّك", "turkce": "Teberrük 🙏", "kalipNo": "91" } ] },
        "ق-د-ر": { "root": ["ق", "د", "ر"], "words": [ { "arapca": "مِقْدَار", "turkce": "Miktâr 📏", "kalipNo": "40" }, { "arapca": "قَدَر", "turkce": "Kader 🌌", "kalipNo": "17" }, { "arapca": "تَقْدِير", "turkce": "Takdir 👍", "kalipNo": "61" }, { "arapca": "مُقَدَّرَات", "turkce": "Mukadderat 🌠", "kalipNo": "63" }, { "arapca": "قُدْرَة", "turkce": "Kudret 💪", "kalipNo": "21" }, { "arapca": "اِقْتِدَار", "turkce": "İktidar 🏛️", "kalipNo": "80" }, { "arapca": "قَادِر", "turkce": "Kâdir ⚡", "kalipNo": "33" }, { "arapca": "مُقْتَدِر", "turkce": "Muktedir 🌟", "kalipNo": "81" }, { "arapca": "قَدِير", "turkce": "Kâdir ✨", "kalipNo": "35" } ] },
        "م-ل-ك": { "root": ["م", "ل", "ك"], "words": [ { "arapca": "مَلَك", "turkce": "Melek 😇", "kalipNo": "17" }, { "arapca": "مُلْك", "turkce": "Mülk 👑", "kalipNo": "21" }, { "arapca": "مَالِك", "turkce": "Malik 🔑", "kalipNo": "33" }, { "arapca": "مَلِيك", "turkce": "Melik 🤴", "kalipNo": "35" }, { "arapca": "مَمْلُوك", "turkce": "Memluk 💂", "kalipNo": "36" }, { "arapca": "مَمْلَكَة", "turkce": "Memleket 🇹🇷", "kalipNo": "38" }, { "arapca": "أَمْلَاك", "turkce": "Emlak 🏘️", "kalipNo": "41" } ] },
        "ر-س-ل": { "root": ["ر", "س", "ل"], "words": [ { "arapca": "رِسَالَة", "turkce": "Risale 📜", "kalipNo": "23" }, { "arapca": "رَسُول", "turkce": "Resul 🗣️", "kalipNo": "26" }, { "arapca": "أَرْسَل", "turkce": "Ersel 🕊️", "kalipNo": "30" }, { "arapca": "إِرْسَالِيَّة", "turkce": "İrsaliye 🧾", "kalipNo": "55" }, { "arapca": "مُرْسَل", "turkce": "Mürsel 📨", "kalipNo": "57" } ] },
        "ن-ص-ر": { "root": ["ن", "ص", "ر"], "words": [ { "arapca": "نَصْر", "turkce": "Nasr 🏆", "kalipNo": "19" }, { "arapca": "نُصْرَة", "turkce": "Nusret ✌️", "kalipNo": "21" }, { "arapca": "نَاصِر", "turkce": "Nasır 🛡️", "kalipNo": "33" }, { "arapca": "مَنْصُور", "turkce": "Mansur 🥇", "kalipNo": "36" } ] },
        "ح-م-ل": { "root": ["ح", "م", "ل"], "words": [ { "arapca": "حَمْلَة", "turkce": "Hamle ♟️", "kalipNo": "19" }, { "arapca": "حَامِلَة", "turkce": "Hamile 🤰", "kalipNo": "33" }, { "arapca": "حَمَّال", "turkce": "Hammal 🎒", "kalipNo": "34" }, { "arapca": "اِحْتِمَال", "turkce": "İhtimal 🎲", "kalipNo": "80" }, { "arapca": "مُحْتَمَل", "turkce": "Muhtemel ✅", "kalipNo": "82" }, { "arapca": "تَحَمُّل", "turkce": "Tahammül 🏋️", "kalipNo": "91" } ] },
        "ح-ق-ق": { "root": ["ح", "ق", "ق"], "words": [ { "arapca": "حَقّ", "turkce": "Hak ⚖️", "kalipNo": "19" }, { "arapca": "حُقُوق", "turkce": "Hukuk 🏛️", "kalipNo": "43" }, { "arapca": "حَقِيقة", "turkce": "Hakikat 💎", "kalipNo": "35" }, { "arapca": "تَحْقِيق", "turkce": "Tahkik 🕵️", "kalipNo": "61" }, { "arapca": "مُحَقَّق", "turkce": "Muhakkak ✅", "kalipNo": "63" }, { "arapca": "اِسْتِحْقَاق", "turkce": "İstihkak 🏅", "kalipNo": "103" }, { "arapca": "مُسْتَحَقّ", "turkce": "Müstehak 👍", "kalipNo": "105" } ] },
        "خ-ل-ص": { "root": ["خ", "ل", "ص"], "words": [ { "arapca": "خَالِص", "turkce": "Halis 💧", "kalipNo": "33" }, { "arapca": "إِخْلَاص", "turkce": "İhlas 💖", "kalipNo": "55" }, { "arapca": "مُخْلِص", "turkce": "Muhlis 😊", "kalipNo": "56" } ] },
        "ك-م-ل": { "root": ["ك", "م", "ل"], "words": [ { "arapca": "كَمَال", "turkce": "Kemâl ✨", "kalipNo": "22" }, { "arapca": "كَامِل", "turkce": "Kâmil 🌟", "kalipNo": "33" }, { "arapca": "إِكْمَال", "turkce": "İkmal 🏁", "kalipNo": "55" }, { "arapca": "تَكْمِيل", "turkce": "Tekmil ✅", "kalipNo": "61" }, { "arapca": "مُكَمَّل", "turkce": "Mükemmel 💯", "kalipNo": "63" } ] },
        "ر-ش-د": { "root": ["ر", "ش", "د"], "words": [ { "arapca": "رَشِيد", "turkce": "Reşîd 🧠", "kalipNo": "35" }, { "arapca": "رُشْد", "turkce": "Rüşd 🧑", "kalipNo": "21" }, { "arapca": "إِرْشَاد", "turkce": "İrşad 🧭", "kalipNo": "55" }, { "arapca": "رَشَاد", "turkce": "Reşât ✨", "kalipNo": "22" }, { "arapca": "مُرْشِد", "turkce": "Mürşid 🧑‍🏫", "kalipNo": "56" }, { "arapca": "رَاشِد", "turkce": "Râşid 🚶", "kalipNo": "33" } ] },
        "أ-م-ن": { "root": ["أ", "م", "ن"], "words": [ { "arapca": "أَمَان", "turkce": "Eman 🛡️", "kalipNo": "22" }, { "arapca": "أَمِين", "turkce": "Emin 🔒", "kalipNo": "35" }, { "arapca": "إِيمَان", "turkce": "İman 💖", "kalipNo": "55" }, { "arapca": "مُؤْمِن", "turkce": "Mümin 🙏", "kalipNo": "56" }, { "arapca": "تَأْمِين", "turkce": "Temin 🤝", "kalipNo": "61" } ] },
        "ج-م-ع": { "root": ["ج", "م", "ع"], "words": [ { "arapca": "جَمْع", "turkce": "Cem 👥", "kalipNo": "19" }, { "arapca": "جَمْعِيَّة", "turkce": "Cemiyet 🏛️", "kalipNo": "19" }, { "arapca": "جَمَاعة", "turkce": "Cemaat 👨‍👩‍👧‍👦", "kalipNo": "22" }, { "arapca": "جَامِع", "turkce": "Cami 🕌", "kalipNo": "33" }, { "arapca": "جَامِعَة", "turkce": "Camia 🎓", "kalipNo": "33" }, { "arapca": "مَجْمُوعَة", "turkce": "Mecmua 📚", "kalipNo": "36" }, { "arapca": "اِجْتِمَاع", "turkce": "İçtima 🤝", "kalipNo": "80" } ] },
        "ح-م-د": { "root": ["ح", "م", "د"], "words": [ { "arapca": "حَمْد", "turkce": "Hamd 🙏", "kalipNo": "19" }, { "arapca": "حَمْدِيَّة", "turkce": "Hamdiye 🌸", "kalipNo": "19" }, { "arapca": "أَحْمَد", "turkce": "Ahmet 🌟", "kalipNo": "30" }, { "arapca": "حَمِيد", "turkce": "Hamît 😊", "kalipNo": "35" }, { "arapca": "مَحْمُود", "turkce": "Mahmut ✨", "kalipNo": "36" }, { "arapca": "مُحَمَّد", "turkce": "Muhammet 💖", "kalipNo": "63" } ] },
        "ش-ه-ر": { "root": ["ش", "ه", "ر"], "words": [ { "arapca": "شَهْر", "turkce": "Şehir 📅", "kalipNo": "19" }, { "arapca": "شُهْرَة", "turkce": "Şöhret 🌟", "kalipNo": "21" }, { "arapca": "مَشْهُور", "turkce": "Meşhur 🤩", "kalipNo": "36" }, { "arapca": "تَشْهِير", "turkce": "Teşhir 🎨", "kalipNo": "61" } ] },
        "ش-ك-ر": { "root": ["ش", "ك", "ر"], "words": [ { "arapca": "شُكْر", "turkce": "Şükür 🙏", "kalipNo": "21" }, { "arapca": "شُكْرِي", "turkce": "Şükri 🧑", "kalipNo": "21" }, { "arapca": "شُكْرَان", "turkce": "Şükran 💖", "kalipNo": "27" }, { "arapca": "شَاكِر", "turkce": "Şakir 😊", "kalipNo": "33" }, { "arapca": "تَشَكُّر", "turkce": "Teşekkür 🙌", "kalipNo": "91" }, { "arapca": "مُتَشَكِّر", "turkce": "Müteşekkir 🥰", "kalipNo": "92" } ] },
        "ف-ك-ر": { "root": ["ف", "ك", "ر"], "words": [ { "arapca": "فِكْر", "turkce": "Fikir 🧠", "kalipNo": "20" }, { "arapca": "فِكْرِي", "turkce": "Fikri 🧐", "kalipNo": "20" }, { "arapca": "فِكْرَة", "turkce": "Fıkra 😂", "kalipNo": "20" }, { "arapca": "تَفَكُّر", "turkce": "Tefekkür 🤔", "kalipNo": "91" }, { "arapca": "مُتَفَكِّر", "turkce": "Mütefekkir 🧘", "kalipNo": "92" } ] },
        "و-ك-ل": { "root": ["و", "ك", "ل"], "words": [ { "arapca": "وَكَالَة", "turkce": "Vekalet 📜", "kalipNo": "22" }, { "arapca": "وَكِيل", "turkce": "Vekil 🧑‍💼", "kalipNo": "35" }, { "arapca": "مُوَكِّل", "turkce": "Müvekkil 👤", "kalipNo": "62" }, { "arapca": "تَوَكُّل", "turkce": "Tevekkül 🤲", "kalipNo": "91" } ] },
        "ك-ب-ر": { "root": ["ك", "ب", "ر"], "words": [ { "arapca": "كِبْر", "turkce": "Kibr 😤", "kalipNo": "20" }, { "arapca": "كِبَار", "turkce": "Kibar 😊", "kalipNo": "44" }, { "arapca": "أَكْبَر", "turkce": "Ekber ⬆️", "kalipNo": "50" }, { "arapca": "كُبْرَى", "turkce": "Kübra 🌟", "kalipNo": "51" }, { "arapca": "تَكْبِير", "turkce": "Tekbir ☝️", "kalipNo": "61" } ] },
        "ع-ج-ز": { "root": ["ع", "ج", "ز"], "words": [ { "arapca": "عَاجِز", "turkce": "Âciz 😩", "kalipNo": "33" }, { "arapca": "عَجَزَة", "turkce": "Aceze 👥", "kalipNo": "47" }, { "arapca": "مُعْجِزَة", "turkce": "Mucize ✨", "kalipNo": "56" }, { "arapca": "تَعْجِيز", "turkce": "Taciz 🚫", "kalipNo": "61" } ] },
        "ح-ر-م": { "root": ["ح", "ر", "م"], "words": [ { "arapca": "إِحْرَام", "turkce": "İhram 🕋", "kalipNo": "55" }, { "arapca": "حَرَم", "turkce": "Harem 🕌", "kalipNo": "17" }, { "arapca": "مُحَرَّم", "turkce": "Muharrem 🌙", "kalipNo": "63" }, { "arapca": "حَرَام", "turkce": "Haram 🚫", "kalipNo": "22" }, { "arapca": "اِحْتِرَام", "turkce": "İhtiram 🫡", "kalipNo": "80" }, { "arapca": "مَحْرُوم", "turkce": "Mahrum 😔", "kalipNo": "36" }, { "arapca": "مُحْتَرَم", "turkce": "Muhterem 🧐", "kalipNo": "82" }, { "arapca": "مَحْرَم", "turkce": "Mahrem 🤫", "kalipNo": "38" } ] },
        "س-أ-ل": { "root": ["س", "أ", "ل"], "words": [ { "arapca": "سُؤَال", "turkce": "Sual ❓", "kalipNo": "24" }, { "arapca": "مَسْؤُول", "turkce": "Mesul 👮", "kalipNo": "36" }, { "arapca": "مَسْأَلَة", "turkce": "Mesele ❔", "kalipNo": "38" } ] },
        "خ-ل-ف": { "root": ["خ", "ل", "ف"], "words": [] },
        "ع-م-ل": { "root": ["ع", "م", "ل"], "words": [] },
        "خ-ر-ج": { "root": ["خ", "ر", "ج"], "words": [] }, 
        "د-ر-س": { "root": ["د", "ر","س"], "words": [] }
      }
    };
    // Sabitler
    const ALL_AVAILABLE_PATTERNS = Object.keys(embeddedGameData.patterns);
    const patternSoundFiles = { "33": "k1k33.wav", "36": "k1k36.wav" };
    let patternSounds = {};
    const rootColors = ["#007bff", "#dc3545", "#ffc107", "#198754", "#6f42c1", "#fd7e14", "#20c997", "#6610f2"];


    // OYUN MANTIĞI
    document.addEventListener('DOMContentLoaded', () => {
        // DOM Elementleri
        const startScreen = document.getElementById('start-screen');
        const resultsScreen = document.getElementById('results-screen');
        const resultsTitle = document.getElementById('results-title');
        const resultsDetails = document.getElementById('results-details');
        const playAgainButton = document.getElementById('play-again-button');
        const startButtons = document.querySelectorAll('.start-button-option');
        const level2Container = document.getElementById('level2-container');
        const l2DraggableRootWrapper = document.getElementById('l2-draggable-root-wrapper');
        const l2PatternsWrapper = document.getElementById('l2-patterns-wrapper');
        const l2GlobalResult = document.getElementById('l2-global-result');
        const l2Mistakes = document.getElementById('l2-mistakes');
        const nextButton = document.getElementById('next-button'); 
        const l2TurkishWordsProgress = document.getElementById('l2-turkish-words-progress');
        const passiveSuffixesEl = document.querySelector('.l2-passive-suffixes'); 
        const l2RootArea = document.getElementById('l2-root-area');
        const l2BottomArea = document.getElementById('l2-bottom-area'); 

        // Ses Mantiği
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        let arePatternSoundsLoaded = false;
        function loadPatternSounds() {
            if (arePatternSoundsLoaded) return;
            patternSounds = {};
            for (const patternId in patternSoundFiles) {
                try {
                    const audio = new Audio(patternSoundFiles[patternId]);
                    audio.preload = 'auto';
                    patternSounds[patternId] = audio;
                } catch (e) { console.error(`Error loading sound for pattern ${patternId}: ${patternSoundFiles[patternId]}`, e); }
            }
            arePatternSoundsLoaded = true;
            console.log("Pattern sounds loaded:", Object.keys(patternSounds).length);
        }
        async function playGenericSound(type) {
            if (!audioContext) { console.warn("AudioContext desteklenmiyor."); return; }
            if (audioContext.state === 'suspended') {
                try { await audioContext.resume(); console.log("AudioContext kullanıcı etkileşimiyle başlatıldı."); } 
                catch (e) { console.error("AudioContext resume failed:", e); return; }
            }
            if (!arePatternSoundsLoaded) { loadPatternSounds(); }
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            oscillator.connect(gainNode); gainNode.connect(audioContext.destination);
            let freq, vol, duration, waveType; waveType = 'sine';
            switch(type) {
                case 'correct': freq = 523.25; vol = 0.7; duration = 0.15; waveType = 'triangle'; break;
                case 'incorrect': freq = 164.81; vol = 0.6; duration = 0.3; waveType = 'square'; break;
                case 'touch': freq = 220.00; vol = 0.5; duration = 0.05; waveType = 'sine'; break;
                case 'drop': freq = 349.23; vol = 0.8; duration = 0.1; waveType = 'sine'; break;
                default: return;
            }
            oscillator.type = waveType;
            oscillator.frequency.setValueAtTime(freq, audioContext.currentTime);
            gainNode.gain.setValueAtTime(vol, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.0001, audioContext.currentTime + duration);
            oscillator.start(); oscillator.stop(audioContext.currentTime + duration);
        }

        // Oyun Durumu
        let gameState = { isGameActive: false, mode: 1 };
        let l2_totalCorrectPatterns = 0; let l2_correctPatternsFound = 0; 
        let allRoundsCompletedWords = []; 
        let currentDraggableRootCard = null; // Aktif turdaki kök kartını tutar
        let draggedRootElement = null; // Sadece sürükleme anındaki elementi tutar
        let currentRootIndex = 0; let allRoots = []; 
        let ghostElement = null; let stayingClone = null; // Hareketsiz klon
        let currentTurkishWordIndex = 0; let currentCorrectWordsData = [];
        let currentTouchDropTarget = null; // *** YENİ EKLENDİ: Mobil sürükleme hedefi ***
        
        // Önceki 'pointer' değişkenleri SİLİNDİ.

        // HTML DOM'u bir kerelik ayarla
        function setupDOMStructure() {
            // ...
        }

        // Oyun Başlatma
        function initializeGame() {
            try {
                allRoots = Object.values(embeddedGameData.roots).filter(rootData => rootData.words && rootData.words.length > 0) 
                               .sort(() => 0.5 - Math.random());
                if (allRoots.length === 0) { console.error("Oynanacak geçerli kök bulunamadı!"); return; }
                currentRootIndex = 0; allRoundsCompletedWords = []; showScreen('start');
            } catch (error) { console.error("Oyun verisi yüklenemedi veya işlenemedi!", error); }
        }

        // Seviye 2 Mantığı
        function setupLevel2(mode = 1, rootIndex = 0) {
             gameState.mode = parseInt(mode); gameState.isGameActive = false;
             l2_correctPatternsFound = 0; 
             l2DraggableRootWrapper.innerHTML = ''; l2PatternsWrapper.innerHTML = '';
             l2TurkishWordsProgress.innerHTML = ''; l2GlobalResult.textContent = '';
             currentDraggableRootCard = null; // Referansı temizle
             updateMistakeDisplay(); 
             nextButton.classList.add('hidden'); 
             nextButton.classList.remove('pulse-on-appear'); 
             passiveSuffixesEl?.classList.remove('faded');
             l2TurkishWordsProgress.querySelectorAll('.l2-turkish-word').forEach(el => el.classList.remove('faded'));
             
             if (rootIndex >= allRoots.length) { endGameLevel2(true); return; }

             const currentRootData = allRoots[rootIndex];
             if (!currentRootData || !currentRootData.words || currentRootData.words.length === 0) {
                 console.warn(`setupLevel2: Kök ${rootIndex} için kelime bulunamadı, atlanıyor.`);
                 currentRootIndex++;
                 if (currentRootIndex < allRoots.length) { setupLevel2(mode, currentRootIndex); } 
                 else { endGameLevel2(true); }
                 return;
             }

             const kokHarfleri = currentRootData.root;
             const isMobile = window.innerWidth <= 600;
             let allWordsForThisRoot = [...currentRootData.words]; 
             
             if (isMobile) {
                 let uniqueKalıpWords = [];
                 const seenKalıpNumbers = new Set();
                 const wordsByKalıp = allWordsForThisRoot.reduce((acc, word) => {
                    if(!acc[word.kalipNo]) acc[word.kalipNo] = [];
                    acc[word.kalipNo].push(word);
                    return acc;
                 }, {});
                 const shuffledKalıpNumbers = Object.keys(wordsByKalıp).sort(() => 0.5 - Math.random());
                 
                 for (const kalıpNo of shuffledKalıpNumbers) {
                     if(uniqueKalıpWords.length >= 3) break;
                     const wordFromKalıp = wordsByKalıp[kalıpNo][0];
                     uniqueKalıpWords.push(wordFromKalıp);
                 }
                 allWordsForThisRoot = uniqueKalıpWords.slice(0, 3);
             }
             
             currentCorrectWordsData = allWordsForThisRoot;
             l2_totalCorrectPatterns = currentCorrectWordsData.length; 
             currentTurkishWordIndex = 0; 

             const correctPatternIds = currentCorrectWordsData.map(k => k.kalipNo);
             const numCorrect = correctPatternIds.length;
             const totalPatterns = isMobile ? 6 : 10; 
             const numIncorrectNeeded = Math.max(0, totalPatterns - numCorrect); 
             const incorrectPatternIds = ALL_AVAILABLE_PATTERNS
                                            .filter(id => !correctPatternIds.includes(id)) 
                                            .sort(() => 0.5 - Math.random()) 
                                            .slice(0, numIncorrectNeeded); 
             const selectedPatterns = [...correctPatternIds, ...incorrectPatternIds].sort(() => 0.5 - Math.random()); 
             l2PatternsWrapper.innerHTML = ''; 
             const currentColor = rootColors[rootIndex % rootColors.length];

             drawLevel2UI(kokHarfleri, selectedPatterns, correctPatternIds, currentColor); 
             drawTurkishWordsProgress();
             highlightCurrentTurkishWord();
             startLevel2();
        }

        // *** GÜNCELLENDİ: Spec 1 & 2 - Kartı oluştur ve dinleyicileri ata ***
        function drawLevel2UI(kokHarfleri, selectedPatterns, correctPatternIds, currentColor) {
            const isMobile = window.innerWidth <= 600;
            
            // 1. Kartın Oluşturulması
            const rootElement = document.createElement('div');
            rootElement.className = 'l2-draggable-root';
            rootElement.draggable = true; // <-- Spec 1: Sürüklenebilir yap
            rootElement.dataset.kok = JSON.stringify(kokHarfleri);
            rootElement.dir = 'rtl';
            
            currentDraggableRootCard = rootElement; // Global referansı ayarla

            const harfSpan = document.createElement('span');
            harfSpan.textContent = kokHarfleri.join('');
            harfSpan.style.color = currentColor; // <-- Spec 1: Dinamik renk
            rootElement.appendChild(harfSpan);
            
            rootElement.classList.remove('faded');

            // 2. Sürükleme Olaylarının Atanması (Masaüstü)
            rootElement.addEventListener('dragstart', handleDragStart); 
            rootElement.addEventListener('dragend', handleDragEnd);     
            
            // *** YENİ EKLENDİ: Mobil için dokunma olayları ***
            rootElement.addEventListener('touchstart', handleTouchStart, { passive: false });
            
            l2PatternsWrapper.innerHTML = '';
            l2DraggableRootWrapper.innerHTML = ''; 

            if (isMobile) {
                // 1. DOM'a Ekleme (Mobil)
                l2DraggableRootWrapper.appendChild(rootElement);
                selectedPatterns.forEach((patternId) => {
                    const groupElement = createPatternGroup(patternId, correctPatternIds.includes(patternId));
                    l2PatternsWrapper.appendChild(groupElement);
                });
            } else {
                // 1. DOM'a Ekleme (Masaüstü)
                rootElement.style.gridRow = '2 / 4'; 
                rootElement.style.gridColumn = '2 / 3'; 
                rootElement.style.alignSelf = 'center';
                rootElement.style.justifySelf = 'center';
                l2PatternsWrapper.appendChild(rootElement);

                const patternElements = selectedPatterns.map(id => createPatternGroup(id, correctPatternIds.includes(id)));
                
                patternElements.slice(0, 3).forEach((el, i) => { 
                    el.style.gridRow = '1'; el.style.gridColumn = `${i + 1}`; l2PatternsWrapper.appendChild(el); 
                });
                if(patternElements[3]) { patternElements[3].style.gridRow = '2'; patternElements[3].style.gridColumn = '1'; l2PatternsWrapper.appendChild(patternElements[3]); }
                if(patternElements[4]) { patternElements[4].style.gridRow = '2'; patternElements[4].style.gridColumn = '3'; l2PatternsWrapper.appendChild(patternElements[4]); }
                if(patternElements[5]) { patternElements[5].style.gridRow = '3'; patternElements[5].style.gridColumn = '1'; l2PatternsWrapper.appendChild(patternElements[5]); }
                if(patternElements[6]) { patternElements[6].style.gridRow = '3'; patternElements[6].style.gridColumn = '3'; l2PatternsWrapper.appendChild(patternElements[6]); }
                patternElements.slice(7, 10).forEach((el, i) => { 
                    el.style.gridRow = '4'; el.style.gridColumn = `${i + 1}`; l2PatternsWrapper.appendChild(el); 
                });
            }
        }
        
        // *** GÜNCELLENDİ: Spec 5 - Bırakma hedefleri dinleyicileri ***
        function createPatternGroup(patternId, isCorrect) {
             const groupElement = document.createElement('div');
             groupElement.className = 'l2-pattern-group'; 
             groupElement.dataset.patternId = patternId;
             groupElement.dataset.isCorrectForRoot = isCorrect;
             
             // ... (Arapça kalıp ve numara oluşturma kodu - Değişiklik yok) ...
             const numberElement = document.createElement('div');
             numberElement.className = 'l2-pattern-number'; 
             const patternData = embeddedGameData.patterns[patternId];
             if (patternData && patternData.displayComponents && Array.isArray(patternData.displayComponents)) {
                 patternData.displayComponents.forEach(component => {
                    let processedComponent = component; 
                    if (!component.includes('ـ') && component.length === 2 && !['ا', 'و', 'ي', 'ى', 'ة', 'ء', 'أ', 'إ', 'آ'].includes(component[0])) { 
                        const letter = component[0]; const haraka = component[1];
                        if (letter === 'ت') processedComponent = `ـت${haraka}ـ`;
                        else if (letter === 'ي') processedComponent = `ـي${haraka}ـ`;
                    }
                     const span = document.createElement('span');
                     span.textContent = processedComponent; numberElement.appendChild(span);
                 });
             } else {
                 const span = document.createElement('span');
                 span.textContent = patternId; // Fallback
                 numberElement.appendChild(span);
                 console.warn(`Pattern ${patternId} için displayComponents bulunamadı veya dizi değil.`);
             }
             groupElement.appendChild(numberElement); 
             const circleElement = document.createElement('div');
             circleElement.className = 'pattern-number-circle'; circleElement.textContent = patternId;
             groupElement.appendChild(circleElement); 
             // ... (Oluşturma kodu sonu) ...

             // Spec 5: Bırakma hedefleri için dinleyiciler
             groupElement.addEventListener('dragover', handleDragOver);
             groupElement.addEventListener('dragleave', handleDragLeave);
             groupElement.addEventListener('drop', handleDrop);

             return groupElement;
        }

        function drawTurkishWordsProgress() {
            l2TurkishWordsProgress.innerHTML = '';
            currentCorrectWordsData.forEach((wordData, index) => {
                const wordElement = document.createElement('div');
                wordElement.className = 'l2-turkish-word'; wordElement.textContent = wordData.turkce; 
                wordElement.dataset.wordIndex = index; wordElement.dataset.kalipNo = wordData.kalipNo;
                l2TurkishWordsProgress.appendChild(wordElement);
            });
        }
        
        // *** GÜNCELLENDİ: Spec 3 - Vurgu ekleme ***
        function highlightCurrentTurkishWord() {
            l2TurkishWordsProgress.querySelectorAll('.l2-turkish-word').forEach(el => { el.classList.remove('active'); });
            const activeWordEl = l2TurkishWordsProgress.querySelector(`.l2-turkish-word[data-word-index="${currentTurkishWordIndex}"]`);
            if (activeWordEl) { activeWordEl.classList.add('active'); }
            
            // Spec 3: Kök kartına .active sınıfı ekle
            if (currentDraggableRootCard) { 
                currentDraggableRootCard.classList.add('active'); 
            }
        }
        
        function startLevel2() { showScreen('level2'); gameState.isGameActive = true; }
        
        function endGameLevel2(isWin) {
             gameState.isGameActive = false;
             if (isWin) {
                 resultsTitle.textContent = "Tebrikler!";
                 const totalWordsFound = allRoundsCompletedWords.length; 
                 l2GlobalResult.textContent = `Toplam ${totalWordsFound} kelime buldunuz!`;
                 resultsDetails.innerHTML = `<p>Oluşturduğunuz Kelimeler:</p> <div> ${allRoundsCompletedWords
                    .map(data => `<span>${data.arapca || '?'}</span> ${data.turkce || '?'}`) 
                    .join('<br>')} </div>`;
             } else { /*...*/ }
             showScreen('results');
        }
        
        function updateMistakeDisplay() { /*...*/ }
        
        
        // --- MASAÜSTÜ SÜRÜKLEME (HTML5 API) ---

        function handleDragStart(e) {
            if (!gameState.isGameActive) { e.preventDefault(); return; }
            playGenericSound('touch');

            draggedRootElement = e.target; 

            ghostElement = draggedRootElement.cloneNode(true);
            ghostElement.classList.add('drag-ghost');
            ghostElement.style.position = 'absolute'; 
            ghostElement.style.top = '-1000px';      
            document.body.appendChild(ghostElement); 

            stayingClone = draggedRootElement.cloneNode(true);
            stayingClone.style.cssText = 'cursor:default; opacity:0.4; animation:none; z-index:1;';
            stayingClone.classList.remove('active'); 
            
            if (draggedRootElement.parentElement === l2PatternsWrapper) { // Masaüstü
                stayingClone.style.gridRow = draggedRootElement.style.gridRow;
                stayingClone.style.gridColumn = draggedRootElement.style.gridColumn;
                stayingClone.style.alignSelf = 'center';
                stayingClone.style.justifySelf = 'center';
            } else { // Mobil
                 stayingClone.style.position = 'absolute'; 
                 stayingClone.style.top = '0';
                 stayingClone.style.left = '50%';
                 stayingClone.style.transform = 'translateX(-50%)';
            }
            draggedRootElement.parentElement.appendChild(stayingClone);
            
            draggedRootElement.style.opacity = '0';

            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', 'dragging'); 
            
            setTimeout(() => {
                if (ghostElement) {
                    const rect = ghostElement.getBoundingClientRect();
                    const offsetX = rect.width / 2;
                    const offsetY = rect.height / 2;
                    e.dataTransfer.setDragImage(ghostElement, offsetX, offsetY);
                }
            }, 0); 
        }

        function handleDragEnd(e) {
            if (ghostElement) ghostElement.remove();
            if (stayingClone) stayingClone.remove();

            if (draggedRootElement && !draggedRootElement.classList.contains('faded')) {
                draggedRootElement.style.opacity = '1';
            }
            
            draggedRootElement = null;
            ghostElement = null;
            stayingClone = null;
            
            clearHovers();
        }
        
        function handleDragOver(e) { 
            e.preventDefault(); 
            const pg = e.target.closest('.l2-pattern-group'); 
            if (pg && gameState.isGameActive && !pg.querySelector('.l2-derived-word')) { 
                clearHovers(); 
                pg.classList.add('dragover'); 
            } 
        } 
        function handleDragLeave(e) { 
            const pg = e.target.closest('.l2-pattern-group'); 
            if (pg) pg.classList.remove('dragover'); 
        }
        function clearHovers() { 
            l2PatternsWrapper.querySelectorAll('.l2-pattern-group.dragover').forEach(g => g.classList.remove('dragover')); 
        }

        // *** GÜNCELLENDİ: Bırakma mantığı yeniden düzenlendi ***
        function handleDrop(e) {
             e.preventDefault();
             const patternGroup = e.target.closest('.l2-pattern-group');
             processDrop(patternGroup); // Ana mantığı çağır
        }
        
        // *** YENİ: Hem fare hem de dokunma için ortak bırakma mantığı ***
        function processDrop(patternGroup) {
             if (!patternGroup || !draggedRootElement || !gameState.isGameActive) { 
                 if (patternGroup) patternGroup.classList.remove('dragover'); 
                 return; 
             }
             patternGroup.classList.remove('dragover');
             if (patternGroup.querySelector('.l2-derived-word')) return; // Zaten dolu

             playGenericSound('drop');
             const droppedPatternId = patternGroup.dataset.patternId;
             const activeWordEl = l2TurkishWordsProgress.querySelector('.l2-turkish-word.active');
             if (!activeWordEl) return; 
             
             const correctPatternId = activeWordEl.dataset.kalipNo;

             // DOĞRU EŞLEŞME
             if (droppedPatternId === correctPatternId) {
                 playGenericSound('correct');
                 const patternNumberElement = patternGroup.querySelector('.l2-pattern-number'); 
                 if (patternNumberElement) patternNumberElement.classList.add('hidden');
                 
                 const foundWordData = currentCorrectWordsData.find(word => word.kalipNo === correctPatternId);
                 if (foundWordData && foundWordData.arapca) {
                     const derivedWordElement = document.createElement('div'); 
                     derivedWordElement.className = 'l2-derived-word'; 
                     const arabicTextNode = document.createTextNode(foundWordData.arapca + " "); 
                     derivedWordElement.appendChild(arabicTextNode);
                     const turkishText = activeWordEl.textContent || "";
                     const textParts = turkishText.split(' ');
                     const emoji = textParts.length > 1 ? textParts[textParts.length - 1] : ''; 
                     if (emoji) {
                         const emojiSpan = document.createElement('span'); 
                         emojiSpan.textContent = emoji; 
                         derivedWordElement.appendChild(emojiSpan); 
                     }
                     patternGroup.appendChild(derivedWordElement);
                 }
                 activeWordEl.classList.add('correct', 'done'); 
                 setTimeout(() => activeWordEl.classList.remove('correct'), 500);
                 l2_correctPatternsFound++; 
                 if (patternSounds[droppedPatternId]) { patternSounds[droppedPatternId].play().catch(err => console.error("Pattern sound play failed:", err)); }
             
             // YANLIŞ EŞLEŞME
             } else { 
                 playGenericSound('incorrect');
                 patternGroup.classList.add('incorrect-flash'); 
                 activeWordEl.classList.add('incorrect', 'failed'); 
                 setTimeout(() => { 
                     patternGroup.classList.remove('incorrect-flash'); 
                     activeWordEl.classList.remove('incorrect'); 
                 }, 500);
                 
                 const correctGroup = l2PatternsWrapper.querySelector(`.l2-pattern-group[data-pattern-id="${correctPatternId}"]`);
                 if (correctGroup) {
                     correctGroup.classList.add('highlight-correct-pattern');
                     setTimeout(() => {
                         correctGroup.classList.remove('highlight-correct-pattern');
                     }, 1000); 
                 }
             }

             // --- Spec 5: Vurguyu kaldır ---
             activeWordEl.classList.remove('active'); 
             if (currentDraggableRootCard) { // (querySelector yerine global referans kullanıldı)
                 currentDraggableRootCard.classList.remove('active'); 
             }
             
             currentTurkishWordIndex++; 
             
             // --- Spec 7: Tur Sonu ---
             if (currentTurkishWordIndex === l2_totalCorrectPatterns) {
                 gameState.isGameActive = false;
                 
                 if (currentDraggableRootCard) { // (draggedRootElement yerine global referans)
                     currentDraggableRootCard.draggable = false; // Sürüklemeyi kilitle
                     
                     currentDraggableRootCard.classList.add('faded'); // Soluklaştır
                 }
                 
                 if (stayingClone) stayingClone.remove(); // Klonu temizle
                 
                 passiveSuffixesEl?.classList.add('faded');
                 l2TurkishWordsProgress.querySelectorAll('.l2-turkish-word').forEach(el => el.classList.add('faded'));
                 l2PatternsWrapper.querySelectorAll('.l2-pattern-group').forEach(group => { group.classList.add('faded'); });

                 nextButton.classList.remove('hidden'); 
                 nextButton.classList.add('pulse-on-appear');
                 setTimeout(() => nextButton.classList.remove('pulse-on-appear'), 600); 
             
             } else {
                 // Sonraki kelimeye geç
                 setTimeout(() => { highlightCurrentTurkishWord(); }, 300); 
             }
        }
        
        
        // --- Ekran ve Buton Yöneticileri (Değişiklik yok) ---
        function showScreen(screenName) {
            startScreen.classList.add('hidden'); resultsScreen.classList.add('hidden'); level2Container.classList.remove('active');
            if (screenName === 'start') { startScreen.classList.remove('hidden'); } 
            else if (screenName === 'results') { resultsScreen.classList.remove('hidden'); } 
            else if (screenName === 'level2') { level2Container.classList.add('active'); }
        }
        startButtons.forEach(button => {
            button.addEventListener('click', () => { 
                if (audioContext.state === 'suspended') {
                    audioContext.resume().then(() => {
                        playGenericSound('touch'); 
                        const mode = button.dataset.mode; 
                        setupLevel2(1, 0); 
                    });
                } else {
                    playGenericSound('touch'); 
                    const mode = button.dataset.mode; 
                    setupLevel2(1, 0); 
                }
            });
        });
        playAgainButton.addEventListener('click', () => { playGenericSound('touch'); initializeGame(); });
        nextButton.addEventListener('click', () => {
            playGenericSound('touch');
             const currentRootData = allRoots[currentRootIndex];
             if(currentRootData && currentRootData.words){
                const foundWords = currentCorrectWordsData.filter(word => {
                    const el = l2TurkishWordsProgress.querySelector(`.l2-turkish-word[data-word-index="${currentCorrectWordsData.indexOf(word)}"]`);
                    return el && el.classList.contains('done'); 
                });
                allRoundsCompletedWords = allRoundsCompletedWords.concat(foundWords);
             }
            currentRootIndex++; 
            nextButton.classList.add('hidden'); nextButton.classList.remove('pulse-on-appear'); 
            if (currentRootIndex < allRoots.length) { setupLevel2(gameState.mode, currentRootIndex); } 
            else { endGameLevel2(true); }
        });


        // *** YENİ: MOBİL DOKUNMA OLAYLARI (TOUCH EVENTS) ***

        function handleTouchStart(e) {
            if (!gameState.isGameActive) return;
            // Sayfanın kaymasını engelle
            e.preventDefault(); 
            playGenericSound('touch');

            draggedRootElement = e.target.closest('.l2-draggable-root');
            if (!draggedRootElement) return;

            // --- Hayalet Kopyayı Oluştur (handleDragStart'tan uyarlandı) ---
            ghostElement = draggedRootElement.cloneNode(true);
            ghostElement.classList.add('drag-ghost');
            // Stil: Hayaleti parmağı takip edecek şekilde ayarla
            ghostElement.style.transform = 'translate(-50%, -50%) scale(1.05)'; 
            document.body.appendChild(ghostElement); 

            // --- Yerinde Kalan Klonu Oluştur (handleDragStart'tan uyarlandı) ---
            stayingClone = draggedRootElement.cloneNode(true);
            stayingClone.style.cssText = 'cursor:default; opacity:0.4; animation:none; z-index:1;';
            stayingClone.classList.remove('active');
            
            if (draggedRootElement.parentElement === l2PatternsWrapper) { // Masaüstü
                stayingClone.style.gridRow = draggedRootElement.style.gridRow;
                stayingClone.style.gridColumn = draggedRootElement.style.gridColumn;
                stayingClone.style.alignSelf = 'center';
                stayingClone.style.justifySelf = 'center';
            } else { // Mobil
                 stayingClone.style.position = 'absolute'; 
                 stayingClone.style.top = '0';
                 stayingClone.style.left = '50%';
                 stayingClone.style.transform = 'translateX(-50%)';
            }
            draggedRootElement.parentElement.appendChild(stayingClone);
            
            // --- Orijinali Gizle ---
            draggedRootElement.style.opacity = '0';

            // --- Hayaleti Parmağın Olduğu Yere Taşı ---
            const touch = e.touches[0];
            ghostElement.style.left = `${touch.clientX}px`;
            ghostElement.style.top = `${touch.clientY}px`;

            // --- Hareket ve Bırakma Dinleyicilerini Ekle ---
            document.addEventListener('touchmove', handleTouchMove, { passive: false });
            document.addEventListener('touchend', handleTouchEnd);
        }

        function handleTouchMove(e) {
            if (!ghostElement || !draggedRootElement) return;
            // Sayfa kaymasını engelle
            e.preventDefault(); 

            const touch = e.touches[0];
            
            // Hayaleti parmakla hareket ettir
            ghostElement.style.left = `${touch.clientX}px`;
            ghostElement.style.top = `${touch.clientY}px`;

            // Parmağın altındaki hedefi bul
            // Hayaleti geçici olarak gizle ki altındaki elementi bulabilelim
            ghostElement.style.display = 'none'; 
            const elementUnderFinger = document.elementFromPoint(touch.clientX, touch.clientY);
            ghostElement.style.display = ''; // Tekrar göster
            
            const dropTarget = elementUnderFinger ? elementUnderFinger.closest('.l2-pattern-group') : null;

            // 'dragover' ve 'dragleave' mantığını taklit et
            if (dropTarget && gameState.isGameActive && !dropTarget.querySelector('.l2-derived-word')) {
                // Eğer yeni bir hedefe geldiysek, eskisinin vurgusunu kaldır
                if (currentTouchDropTarget && currentTouchDropTarget !== dropTarget) {
                    currentTouchDropTarget.classList.remove('dragover');
                }
                dropTarget.classList.add('dragover');
                currentTouchDropTarget = dropTarget; // Şu anki hedefi sakla
            } else {
                // Eğer bir hedeften ayrıldıysak, vurgusunu kaldır
                if (currentTouchDropTarget) {
                    currentTouchDropTarget.classList.remove('dragover');
                    currentTouchDropTarget = null;
                }
            }
        }

        function handleTouchEnd(e) {
            // --- Bırakma İşlemi ---
            if (currentTouchDropTarget) {
                // Geçerli bir hedefe bıraktık, ana bırakma mantığını çağır
                processDrop(currentTouchDropTarget); 
                currentTouchDropTarget.classList.remove('dragover');
            }

            // --- Temizlik (handleDragEnd'den uyarlandı) ---
            if (ghostElement) ghostElement.remove();
            if (stayingClone) stayingClone.remove();

            // Eğer tur bitmediyse orijinal kartı geri göster
            if (draggedRootElement && !draggedRootElement.classList.contains('faded')) {
                draggedRootElement.style.opacity = '1';
            }
            
            // --- Durumu Sıfırla ---
            draggedRootElement = null;
            ghostElement = null;
            stayingClone = null;
            currentTouchDropTarget = null;

            // --- Dinleyicileri Kaldır ---
            document.removeEventListener('touchmove', handleTouchMove);
            document.removeEventListener('touchend', handleTouchEnd);
        }


        setupDOMStructure(); // HTML'i ilk yüklemede ayarla
        initializeGame();
    });
    </script>
    </body>
</html>